(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const N of document.querySelectorAll('link[rel="modulepreload"]'))y(N);new MutationObserver(N=>{for(const L of N)if(L.type==="childList")for(const x of L.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&y(x)}).observe(document,{childList:!0,subtree:!0});function A(N){const L={};return N.integrity&&(L.integrity=N.integrity),N.referrerPolicy&&(L.referrerPolicy=N.referrerPolicy),N.crossOrigin==="use-credentials"?L.credentials="include":N.crossOrigin==="anonymous"?L.credentials="omit":L.credentials="same-origin",L}function y(N){if(N.ep)return;N.ep=!0;const L=A(N);fetch(N.href,L)}})();(function(w){Date.now||(Date.now=function(){return new Date().getTime()}),Math.trunc||(Math.trunc=function(v){return v<0?Math.ceil(v):Math.floor(v)}),Object.setPrototypeOf||(Object.setPrototypeOf=function(v,A){return v.__proto__=A,v}),w.WebSharper={Runtime:{Ctor:function(v,A){return v.prototype=A.prototype,v},Class:function(v,A,y){var N=v;if(A){N=new A;for(var L in v)N[L]=v[L]}var x=function(K){if(K)for(var le in K)this[le]=K[le]};if(x.prototype=N,y)for(var ie in y)x[ie]=y[ie];return x},Clone:function(v){var A={};for(var y of Object.getOwnPropertyNames(v))A[y]=v[y];return Object.setPrototypeOf(A,Object.getPrototypeOf(v)),A},NewObject:function(v){for(var A={},y=0;y<v.length;y++)A[v[y][0]]=v[y][1];return A},PrintObject:function(v){var A="{ ",y=!0;for(var N of Object.getOwnPropertyNames(v))y?y=!1:A+=", ",A+=N+" = "+v[N];return y?A+="}":A+=" }",A},DeleteEmptyFields:function(v,A){for(var y=0;y<A.length;y++){var N=A[y];v[N]===void 0&&delete v[N]}return v},GetOptional:function(v){return v===void 0?null:{$:1,$0:v}},SetOptional:function(v,A,y){y?v[A]=y.$0:delete v[A]},SetOrDelete:function(v,A,y){y===void 0?delete v[A]:v[A]=y},Apply:function(v,A,y){return v.apply(A,y)},Bind:function(v,A){return function(){return v.apply(this,arguments)}},CreateFuncWithArgs:function(v){return function(){return v(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(v){return function(){return v(this)}},CreateFuncWithThis:function(v){return function(){return v(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(v){return function(){return v(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(v,A){return function(){return A(Array.prototype.slice.call(arguments,0,v).concat([Array.prototype.slice.call(arguments,v)]))}},CreateFuncWithArgsRest:function(v,A){return function(){return A([Array.prototype.slice.call(arguments,0,v),Array.prototype.slice.call(arguments,v)])}},BindDelegate:function(v,A){var y=v.bind(A);return y.$Func=v,y.$Target=A,y},CreateDelegate:function(v){if(v.length==0)return null;if(v.length==1)return v[0];var A=function(){for(var y,N=0;N<v.length;N++)y=v[N].apply(null,arguments);return y};return A.$Invokes=v,A},CombineDelegates:function(v){for(var A=[],y=0;y<v.length;y++){var N=v[y];N&&("$Invokes"in N?A=A.concat(N.$Invokes):A.push(N))}return WebSharper.Runtime.CreateDelegate(A)},DelegateEqual:function(v,A){if(v===A)return!0;if(v==null||A==null)return!1;var y=v.$Invokes||[v],N=A.$Invokes||[A];if(y.length!=N.length)return!1;for(var L=0;L<y.length;L++){var x=y[L],ie=N[L];if(!(x===ie||"$Func"in x&&"$Func"in ie&&x.$Func===ie.$Func&&x.$Target==ie.$Target))return!1}return!0},ThisFunc:function(v){return function(){var A=Array.prototype.slice.call(arguments);return A.unshift(this),v.apply(null,A)}},ThisFuncOut:function(v){return function(){var A=Array.prototype.slice.call(arguments);return v.apply(A.shift(),A)}},ParamsFunc:function(v,A){return function(){var y=Array.prototype.slice.call(arguments);return A.apply(null,y.slice(0,v).concat([y.slice(v)]))}},ParamsFuncOut:function(v,A){return function(){var y=Array.prototype.slice.call(arguments);return A.apply(null,y.slice(0,v).concat(y[v]))}},ThisParamsFunc:function(v,A){return function(){var y=Array.prototype.slice.call(arguments);return y.unshift(this),A.apply(null,y.slice(0,v+1).concat([y.slice(v+1)]))}},ThisParamsFuncOut:function(v,A){return function(){var y=Array.prototype.slice.call(arguments);return A.apply(y.shift(),y.slice(0,v).concat(y[v]))}},Curried:function(v,A,y){return y=y||[],function(N){var L=y.concat([N===void 0?null:N]);return A==1?v.apply(null,L):A==2?function(x){return v.apply(null,L.concat([x===void 0?null:x]))}:WebSharper.Runtime.Curried(v,A-1,L)}},Curried2:function(v){return function(A){return function(y){return v(A,y)}}},Curried3:function(v){return function(A){return function(y){return function(N){return v(A,y,N)}}}},UnionByType:function(v,A,y){for(var N=typeof A,L=0;L<v.length;L++){var x=v[L];if(typeof x=="number"){if(Array.isArray(A)&&(x==0||A.length==x))return{$:L,$0:A}}else if(x==N)return{$:L,$0:A}}if(!y)throw new Error("Type not expected for creating Choice value.")},MarkResizable:function(v){return Object.defineProperty(v,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),v},MarkReadOnly:function(v){return Object.defineProperty(v,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),v},ScriptBasePath:"./",ScriptPath:function(v,A){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":v+"/")+A},OnLoad:function(v){"load"in this||(this.load=[]),this.load.push(v)},Start:function(){function v(A){for(var y=0;y<A.length;y++)A[y]()}"load"in this&&(v(this.load),this.load=[])}}},w.WebSharper.Runtime.OnLoad(function(){w.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()}),w.ignore=function(){},w.id=function(v){return v},w.fst=function(v){return v[0]},w.snd=function(v){return v[1]},w.trd=function(v){return v[2]},w.console||(w.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);var JSON;JSON||(JSON={}),function(){function i(w){return w<10?"0"+w:w}function f(w){return o.lastIndex=0,o.test(w)?'"'+w.replace(o,function(v){var A=s[v];return typeof A=="string"?A:"\\u"+("0000"+v.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+w+'"'}function r(w,v){var A,y,N,L,x=n,ie,K=v[w];switch(K&&typeof K=="object"&&typeof K.toJSON=="function"&&(K=K.toJSON(w)),typeof t=="function"&&(K=t.call(v,w,K)),typeof K){case"string":return f(K);case"number":return isFinite(K)?String(K):"null";case"boolean":case"null":return String(K);case"object":if(!K)return"null";if(n+=u,ie=[],Object.prototype.toString.apply(K)==="[object Array]"){for(L=K.length,A=0;A<L;A+=1)ie[A]=r(A,K)||"null";return N=ie.length===0?"[]":n?`[
`+n+ie.join(`,
`+n)+`
`+x+"]":"["+ie.join(",")+"]",n=x,N}if(t&&typeof t=="object")for(L=t.length,A=0;A<L;A+=1)typeof t[A]=="string"&&(y=t[A],N=r(y,K),N&&ie.push(f(y)+(n?": ":":")+N));else for(y in K)Object.prototype.hasOwnProperty.call(K,y)&&(N=r(y,K),N&&ie.push(f(y)+(n?": ":":")+N));return N=ie.length===0?"{}":n?`{
`+n+ie.join(`,
`+n)+`
`+x+"}":"{"+ie.join(",")+"}",n=x,N}}typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n,u,s={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t;typeof JSON.stringify!="function"&&(JSON.stringify=function(w,v,A){var y;if(n="",u="",typeof A=="number")for(y=0;y<A;y+=1)u+=" ";else typeof A=="string"&&(u=A);if(t=v,v&&typeof v!="function"&&(typeof v!="object"||typeof v.length!="number"))throw new Error("JSON.stringify");return r("",{"":w})}),typeof JSON.parse!="function"&&(JSON.parse=function(n,t){function r(w,v){var A,y,N=w[v];if(N&&typeof N=="object")for(A in N)Object.prototype.hasOwnProperty.call(N,A)&&(y=r(N,A),y!==void 0?N[A]=y:delete N[A]);return t.call(w,v,N)}var i;if(n=String(n),e.lastIndex=0,e.test(n)&&(n=n.replace(e,function(w){return"\\u"+("0000"+w.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return i=eval("("+n+")"),typeof t=="function"?r({"":i},""):i;throw new SyntaxError("JSON.parse")})}();(function(w,v){v=w.Element.prototype,v.matches||(v.matches=v.msMatchesSelector||function(A){for(var y=(this.document||this.ownerDocument).querySelectorAll(A),N=0;y[N]&&y[N]!==e;++N);return!!y[N]}),v.closest||(v.closest=function(A){for(var y=this;y&&y.nodeType==1;){if(y.matches(A))return y;y=y.parentNode}return null})})(self);(function(){for(var w=0,v=["webkit","moz"],A=0;A<v.length&&!window.requestAnimationFrame;++A)window.requestAnimationFrame=window[v[A]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[v[A]+"CancelAnimationFrame"]||window[v[A]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(y,N){var L=new Date().getTime(),x=Math.max(0,16-(L-w)),ie=window.setTimeout(function(){y(L+x)},x);return w=L+x,ie}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(y){clearTimeout(y)})})();(function(w){var v,A,y,N,L,x,ie,K,le,M,St,He,he,W,Rn,It,ht,m,Un,On,Ge,dt,de,bt,zt,T,Vt,Qt,R,G,Cn,qn,Wn,At,fr,Y,Oe,vn,pt,fe,$t,ue,Je,_e,_,Hn,Bn,Zt,Et,nt,Be,Tt,Xt,jn,Yt,ae,Lt,ze,en,pe,Ne,tn,Kn,En,yn,mt,Nn,Qe,at,gt,Rt,Tn,nn,Ee,me,rn,un,Dn,Z,on,be,Le,Dt,re,kn,Ce,Te,an,ln,cn,Ut,wt,B,xn,Ve,Gn,Jn,zn,Qn,sn,kt,Re,fn,xt,ce,Zn,_t,Xn,_n,lt,hn,Fn,Yn,se,hr,Ze,rt,dn,Ot,er,Ct,tr,qt,ve,Se,we,it,Ae,Mn,nr,ye,ee,rr,Pn,In,bn,Vn,Ln,Pe,vt,pn,Wt,ir,De,Fe,$n,ur,mn,Sn,Me,Ht,Xe,ct,gn,Q,Ft,qe,te,Bt,ut,yt,or,ar,jt,wn,lr,cr,E,An,sr,ke,Kt;v=w.MySPA=w.MySPA||{},A=v.Client=v.Client||{},y=w.StartupCode$MySPA$Client=w.StartupCode$MySPA$Client||{},N=w.WebSharper=w.WebSharper||{},L=N.Obj=N.Obj||{},x=N.UI=N.UI||{},ie=x.Var$1=x.Var$1||{},K=N.List=N.List||{},le=K.T=K.T||{},M=v.Pages=v.Pages||{},St=M.Stock=M.Stock||{},He=x.ListModel=x.ListModel||{},he=N.Operators=N.Operators||{},W=x.View=x.View||{},Rn=w.MySPA_Router=w.MySPA_Router||{},It=w.MySPA_Templates=w.MySPA_Templates||{},ht=x.Router=x.Router||{},m=N.Arrays=N.Arrays||{},Un=x.Templating=x.Templating||{},On=Un.Runtime=Un.Runtime||{},Ge=On.Server=On.Server||{},dt=Ge.ProviderBuilder=Ge.ProviderBuilder||{},de=x.TemplateHole=x.TemplateHole||{},bt=x.Var=x.Var||{},zt=x.ConcreteVar=x.ConcreteVar||{},T=x.Snap=x.Snap||{},Vt=N.Random=N.Random||{},Qt=x.Storage=x.Storage||{},R=N.Seq=N.Seq||{},G=N.Concurrency=N.Concurrency||{},Cn=N.JavaScript=N.JavaScript||{},qn=Cn.JS=Cn.JS||{},Wn=N.ClientSideJson=N.ClientSideJson||{},At=Wn.Provider=Wn.Provider||{},fr=Cn.Pervasives=Cn.Pervasives||{},Y=N.Enumerator=N.Enumerator||{},Oe=N.Sitelets=N.Sitelets||{},vn=Oe.RouterOperators=Oe.RouterOperators||{},pt=Oe.RouterModule=Oe.RouterModule||{},fe=Oe.Route=Oe.Route||{},$t=Ge.TemplateInstance=Ge.TemplateInstance||{},ue=x.TemplateHoleModule=x.TemplateHoleModule||{},Je=ue.Elt=ue.Elt||{},_e=ue.Text=ue.Text||{},_=N.Unchecked=N.Unchecked||{},Hn=w.System=w.System||{},Bn=Hn.Guid=Hn.Guid||{},Zt=N.Control=N.Control||{},Et=Zt.FSharpEvent=Zt.FSharpEvent||{},nt=Ge.Handler=Ge.Handler||{},Be=N.Charting=N.Charting||{},Tt=Be.Renderers=Be.Renderers||{},Xt=Tt.ChartJs=Tt.ChartJs||{},jn=Be.LiveChart=Be.LiveChart||{},Yt=v.Chart=v.Chart||{},ae=x.Doc=x.Doc||{},Lt=x.Abbrev=x.Abbrev||{},ze=Lt.Fresh=Lt.Fresh||{},en=Qt.ArrayStorage=Qt.ArrayStorage||{},pe=N.Collections=N.Collections||{},Ne=pe.Dictionary=pe.Dictionary||{},tn=w.Object,Kn=Oe.Router=Oe.Router||{},En=Oe.List=Oe.List||{},yn=N.Option=N.Option||{},mt=w.Node,Nn=N.Numeric=N.Numeric||{},Qe=ue.TextView=ue.TextView||{},at=ue.VarFloatUnchecked=ue.VarFloatUnchecked||{},gt=ue.VarStr=ue.VarStr||{},Rt=ue.EventQ=ue.EventQ||{},Tn=Zt.Event=Zt.Event||{},nn=Tn.Event=Tn.Event||{},Ee=Tt.ChartJsInternal=Tt.ChartJsInternal||{},me=Be.Charts=Be.Charts||{},rn=me.LineChart=me.LineChart||{},un=Be.Pervasives=Be.Pervasives||{},Dn=Be.Chart=Be.Chart||{},Z=x.Docs=x.Docs||{},on=G.Scheduler=G.Scheduler||{},be=Y.T=Y.T||{},Le=pe.FSharpMap=pe.FSharpMap||{},Dt=pe.Map=pe.Map||{},re=N.Strings=N.Strings||{},kn=N.Utils=N.Utils||{},Ce=pe.HashSet=pe.HashSet||{},Te=Ge.TemplateInitializer=Ge.TemplateInitializer||{},an=ue.VarBool=ue.VarBool||{},ln=ue.VarDateTime=ue.VarDateTime||{},cn=ue.VarFile=ue.VarFile||{},Ut=ue.VarDomElement=ue.VarDomElement||{},wt=x.Client=x.Client||{},B=wt.Templates=wt.Templates||{},xn=G.AsyncBody=G.AsyncBody||{},Ve=w.StartupCode$WebSharper_Main$Concurrency=w.StartupCode$WebSharper_Main$Concurrency||{},Gn=G.CT=G.CT||{},Jn=me.ChartConfig=me.ChartConfig||{},zn=me.SeriesChartConfig=me.SeriesChartConfig||{},Qn=me.ColorConfig=me.ColorConfig||{},sn=w.StartupCode$WebSharper_Charting$Renderers=w.StartupCode$WebSharper_Charting$Renderers||{},kt=Be.Reactive=Be.Reactive||{},Re=w.StartupCode$WebSharper_Charting$Charts=w.StartupCode$WebSharper_Charting$Charts||{},fn=me.PieChart=me.PieChart||{},xt=w.StartupCode$WebSharper_UI$Abbrev=w.StartupCode$WebSharper_UI$Abbrev||{},ce=pe.BalancedTree=pe.BalancedTree||{},Zn=ce.Tree=ce.Tree||{},_t=pe.Pair=pe.Pair||{},Xn=pe.DictionaryUtil=pe.DictionaryUtil||{},_n=w.Error,lt=N.OperationCanceledException=N.OperationCanceledException||{},hn=N.CancellationTokenSource=N.CancellationTokenSource||{},Fn=x.HtmlModule=x.HtmlModule||{},Yn=Fn.attr=Fn.attr||{},se=x.AttrModule=x.AttrModule||{},hr=w.Element,Ze=N.Slice=N.Slice||{},rt=un.Color=un.Color||{},dn=Ee.BatchUpdater=Ee.BatchUpdater||{},Ot=N.Util=N.Util||{},er=me.PolarData=me.PolarData||{},Ct=x.DocElemNode=x.DocElemNode||{},tr=pe.MapUtil=pe.MapUtil||{},qt=Oe.PathUtil=Oe.PathUtil||{},ve=w.StartupCode$WebSharper_UI$Templates=w.StartupCode$WebSharper_UI$Templates||{},Se=B.Prepare=B.Prepare||{},we=x.DomUtility=x.DomUtility||{},it=x.Elt=x.Elt||{},Ae=x.An=x.An||{},Mn=wt.Settings=wt.Settings||{},nr=Lt.Mailbox=Lt.Mailbox||{},ye=x.AttrProxy=x.AttrProxy||{},ee=x.Attrs=x.Attrs||{},rr=wt.Attrs=wt.Attrs||{},Pn=rr.Dyn=rr.Dyn||{},In=ue.Attribute=ue.Attribute||{},bn=ue.Event=ue.Event||{},Vn=ue.AfterRender=ue.AfterRender||{},Ln=ue.AfterRenderQ=ue.AfterRenderQ||{},Pe=x.Array=x.Array||{},vt=x.Updates=x.Updates||{},pn=pe.ValueCollection=pe.ValueCollection||{},Wt=wt.Docs=wt.Docs||{},ir=Wt.RunState=Wt.RunState||{},De=Wt.NodeSet=Wt.NodeSet||{},Fe=x.Anims=x.Anims||{},$n=w.StartupCode$WebSharper_UI$Doc_Proxy=w.StartupCode$WebSharper_UI$Doc_Proxy||{},ur=N.Queue=N.Queue||{},mn=pe.KeyCollection=pe.KeyCollection||{},Sn=pe.HashSetUtil=pe.HashSetUtil||{},Me=w.StartupCode$WebSharper_UI$DomUtility=w.StartupCode$WebSharper_UI$DomUtility||{},Ht=w.StartupCode$WebSharper_UI$Animation=w.StartupCode$WebSharper_UI$Animation||{},Xe=x.AppendList=x.AppendList||{},ct=N.KeyNotFoundException=N.KeyNotFoundException||{},gn=x.DynamicAttrNode=x.DynamicAttrNode||{},Q=w.StartupCode$WebSharper_UI$Attr_Client=w.StartupCode$WebSharper_UI$Attr_Client||{},Ft=x.Easing=x.Easing||{},qe=Lt.HashSet=Lt.HashSet||{},te=x.BindVar=x.BindVar||{},Bt=x.String=x.String||{},ut=x.CheckedInput=x.CheckedInput||{},yt=Wt.DomNodes=Wt.DomNodes||{},or=N.Char=N.Char||{},ar=N.DateUtil=N.DateUtil||{},jt=N.Lazy=N.Lazy||{},wn=w.StartupCode$WebSharper_UI$AppendList=w.StartupCode$WebSharper_UI$AppendList||{},lr=N.LazyExtensionsProxy=N.LazyExtensionsProxy||{},cr=lr.LazyRecord=lr.LazyRecord||{},E=N&&N.Runtime,An=w.Math,sr=w.JSON,ke=w.console,Kt=w.Date,A.Main=function(){return y.$cctor(),y.Main},A.router=function(){return y.$cctor(),y.router},A.currentPage=function(){return y.$cctor(),y.currentPage},y.$cctor=function(){var a,l,c,h,d,p,$;y.$cctor=w.ignore,y.categoryIncome=ie.Create$1(""),y.amountIncome=ie.Create$1(0),y.totalIncome=ie.Create$1(0),y.categoryExpenses=ie.Create$1(""),y.amountExpenses=ie.Create$1(0),y.totalExpenses=ie.Create$1(0),y.incomeData=ie.Create$1([le.Empty,le.Empty]),y.expenseData=ie.Create$1([le.Empty,le.Empty]),y.stockName=ie.Create$1(""),y.stockAmount=ie.Create$1(0),y.stockPrice=ie.Create$1(0),y.stockData=K.ofArray([St.New("Apple",1.1,189,M.randomStockLastPrice(189)),St.New("Alphabet",1.1,170,M.randomStockLastPrice(170)),St.New("Microsoft",1.3,416,M.randomStockLastPrice(416))]),y.stockModel=(a=He.Create(function(g){return g.Name},M.loadStockData()),W.Sink(function(g){M.saveStockData(K.ofSeq(g))},a.v),a),y.router=Rn.r(),y.currentPage=ht.InstallHash({$:0},A.router()),y.Main=(l=(c=ae.EmbedView(W.Map(function(g){return g.$==1?M.StockPage():M.MoneyPage()},A.currentPage().get_View())),h=(d=(p=new dt.New$1,p.h.push(new _e.New("tomoneypage","/#/")),p),d.h.push(new _e.New("tostockpage","/#/stockPortfolio")),d),h.h.push(new Je.New("pagecontent",c)),h),$=nt.CompleteHoles(l.k,l.h,[]),l.i=new $t.New($[1],B.RunFullDocTemplate($[0])))},L=N.Obj=E.Class({Equals:function(a){return this===a},GetHashCode:function(){return-1}},null,L),L.New=E.Ctor(function(){},L),ie=x.Var$1=E.Class({},L,ie),ie.Create$1=function(a){return new zt.New(!1,T.New({$:2,$0:a,$1:[]}),a)},le=K.T=E.Class({GetEnumerator:function(){return new be.New(this,null,function(a){var l;return l=a.s,l.$==0?!1:(a.c=l.$0,a.s=l.$1,!0)},void 0)}},null,le),le.Empty=new le({$:0}),K.ofArray=function(a){var l,c,h;for(l=le.Empty,c=m.length(a)-1,h=0;c>=h;c--)l=new le({$:1,$0:m.get(a,c),$1:l});return l},K.ofSeq=function(a){var l,c,h,d,p,$;if(a instanceof le)return a;if(a instanceof w.Array)return K.ofArray(a);l=Y.Get(a);try{if(h=l.MoveNext(),!h)c=le.Empty;else{for(p=new le({$:1}),d=p;h;)d.$0=l.Current(),l.MoveNext()?d=($=new le({$:1}),d.$1=$,$):h=!1;d.$1=le.Empty,c=p}return c}finally{typeof l=="object"&&"Dispose"in l&&l.Dispose()}},K.map=function(a,l){var c,h,d,p,$;if(l.$==0)return l;for(p=new le({$:1}),c=p,h=l,d=!0;d;)c.$0=a(h.$0),h=h.$1,h.$==0?d=!1:c=($=new le({$:1}),c.$1=$,$);return c.$1=le.Empty,p},K.iter=function(a,l){var c;for(c=l;c.$==1;)a(K.head(c)),c=K.tail(c)},K.init=function(a,l){return K.ofArray(m.init(a,l))},K.rev=function(a){var l,c;for(l=le.Empty,c=a;c.$==1;)l=new le({$:1,$0:c.$0,$1:l}),c=c.$1;return l},K.zip=function(a,l){return K.map2(function(c,h){return[c,h]},a,l)},K.append=function(a,l){var c,h,d,p,$;if(a.$==0)return l;if(l.$==0)return a;for(p=new le({$:1}),c=p,h=a,d=!0;d;)c.$0=h.$0,h=h.$1,h.$==0?d=!1:c=($=new le({$:1}),c.$1=$,$);return c.$1=l,p},K.map2=function(a,l,c){var h,d,p,$,g,C;if(h=l.$==1&&c.$==1,h){for(g=new le({$:1}),d=g,p=l,$=c;h;)d.$0=a(p.$0,$.$0),p=p.$1,$=$.$1,p.$==1&&$.$==1?d=(C=new le({$:1}),d.$1=C,C):h=!1;return(p.$==1||$.$==1)&&K.badLengths(),d.$1=le.Empty,g}else return l.$==1||c.$==1?K.badLengths():l},K.head=function(a){return a.$==1?a.$0:K.listEmpty()},K.tail=function(a){return a.$==1?a.$1:K.listEmpty()},K.badLengths=function(){return he.FailWith("The lists have different lengths.")},K.listEmpty=function(){return he.FailWith("The input list was empty.")},St.New=function(a,l,c,h){return{Name:a,Amount:l,Price:c,LastPrice:h}},M.randomStockLastPrice=function(a){return 20*(new Vt.New,An.random())+(a-10)},M.saveStockData=function(a){var l;l=sr.stringify(At.EncodeList(At.Id())()(a)),self.localStorage.setItem("stocks",l)},M.loadStockData=function(){var a;if(a=self.localStorage.getItem("stocks"),a==null)return M.stockData();try{return K.map(function(l){return St.New(l.Name,l.Amount,l.Price,M.randomStockLastPrice(l.Price))},At.DecodeList(At.Id())()(sr.parse(a)))}catch{return M.stockData()}},M.StockPage=function(){var a,l,c,h,d,p,$,g,C,S,D,q,F,I,P,b,j,k,U,O,H,V,z;return M.startUpdatingLastPrices(),a=W.Map(function(J){return R.sumBy(function(X){return X.LastPrice*X.Amount},J)},M.stockModel().v),l=new Et.New,c=Xt.Render$8(jn.Line(l.event),{$:1,$0:{$:0,$0:1400,$1:300}},null,{$:1,$0:10}),G.Start(G.Delay(function(){return G.While(function(){return!0},G.Delay(function(){return G.Bind(G.Sleep(3e3),function(){return G.Bind(W.GetAsync(a),function(J){return l.event.Trigger(J),G.Zero()})})}))}),null),h=W.Map(function(J){return R.sumBy(function(X){return X.LastPrice*X.Amount-X.Price*X.Amount},J)},M.stockModel().v),(d=(p=($=(g=W.Map(function(J){return J>=0?"rgb(0, 210, 0)":"red"},h),C=(S=W.Map(function(J){return J.toFixed(2)},W.Map2(function(J,X){return X*100/J},a,h)),D=(q=W.Map(function(J){return J.toFixed(2)+"$"},h),F=(I=W.Map(function(J){return J.toFixed(2)+"$"},a),P=(b=(j=(k=(U=ae.Convert(function(J){var X,ne,$e,oe,ge,Ue,xe,Ye,je,Mt,Ie,Ke,et,st,ot,Gt,We,tt,Nt,Jt,Pt;function ft(dr){return dr.toFixed(2)}return X=J.Amount*J.Price,ne=J.LastPrice*J.Amount,$e=ne-X,(oe=(ge=(Ue=ft(ne),xe=(Ye=ft(X),je=(Mt=ft($e),Ie=(Ke=(et=ft(J.LastPrice),st=(ot=ft(J.Price),Gt=(We=ft(J.Amount),tt=(Nt=new dt.New$1,Nt.h.push(new _e.New("stockname",J.Name)),Nt),tt.h.push(new _e.New("stockamount",We)),tt),Gt.h.push(new _e.New("stockprice",ot)),Gt),st.h.push(new _e.New("stocklast",et)),st),Ke.h.push(new _e.New("color",$e>=0?"rgb(0, 210, 0)":"red")),Ke),Ie.h.push(new _e.New("stockprofitandloss",Mt)),Ie),je.h.push(new _e.New("stockcostbasis",Ye)),je),xe.h.push(new _e.New("stockmarketvalue",Ue)),xe),ge.h.push(nt.EventQ2(ge.k,"remove",function(){return ge.i},function(){M.stockModel().RemoveByKey(J.Name)})),ge),Jt=nt.CompleteHoles(oe.k,oe.h,[]),Pt=new $t.New(Jt[1],It.stocklist(Jt[0])),oe.i=Pt,Pt).get_Doc()},M.stockModel().v),O=(H=new dt.New$1,H.h.push(new _e.New("headerspa","Stock Portfolio")),H),O.h.push(new Je.New("stocktablebody",U)),O),k.h.push(new gt.New("stockname",M.stockName())),k),j.h.push(new at.New("stockamount",M.stockAmount())),j),b.h.push(new at.New("stockprice",M.stockPrice())),b),P.h.push(new Qe.New("assetamount",I)),P),F.h.push(new Qe.New("assetprofitandloss",q)),F),D.h.push(new Qe.New("assetprofitandlosspercent",S)),D),C.h.push(new Qe.New("colorprofitandloss",g)),C),$.h.push(nt.EventQ2($.k,"add",function(){return $.i},function(){var J;M.stockName().Get()!=""&&M.stockAmount().Get()>0&&M.stockPrice().Get()>0?(J=St.New(M.capitalize(M.stockName().Get()),M.stockAmount().Get(),M.stockPrice().Get(),M.randomStockLastPrice(M.stockPrice().Get())),M.stockModel().Append(J),M.stockName().Set(""),M.stockAmount().Set(0),M.stockPrice().Set(0)):M.emptyAlert()})),$),p.h.push(new Je.New("assetchart",c)),p),V=nt.CompleteHoles(d.k,d.h,[["stockname",0,null],["stockamount",1,null],["stockprice",1,null]]),z=new $t.New(V[1],It.stockportfolio(V[0])),d.i=z,z).get_Doc()},M.MoneyPage=function(){var a,l,c,h,d,p,$,g,C,S,D,q,F,I,P,b,j,k,U,O,H,V,z,J,X;function ne(){var oe;M.totalIncome().Set(M.totalIncome().Get()+M.amountIncome().Get()),oe=M.incomeData().Get(),M.incomeData().Set([K.append(oe[0],K.ofArray([M.categoryIncome().Get()])),K.append(oe[1],K.ofArray([M.amountIncome().Get()]))]),M.categoryIncome().Set(""),M.amountIncome().Set(0)}function $e(){var oe;M.totalExpenses().Set(M.totalExpenses().Get()+M.amountExpenses().Get()),oe=M.expenseData().Get(),M.expenseData().Set([K.append(oe[0],K.ofArray([M.categoryExpenses().Get()])),K.append(oe[1],K.ofArray([M.amountExpenses().Get()]))]),M.categoryExpenses().Set(""),M.amountExpenses().Set(0)}return a=W.Map2(function(oe,ge){return(oe-ge).toFixed(2)},M.totalIncome().get_View(),M.totalExpenses().get_View()),l=W.Map(function(oe){return oe.toFixed(2)},M.totalIncome().get_View()),c=W.Map(function(oe){return oe.toFixed(2)},M.totalExpenses().get_View()),h=W.Map2(Yt.createPieChart,W.Map(function(oe){return oe[0]},M.incomeData().get_View()),W.Map(function(oe){return oe[1]},M.incomeData().get_View())),d=W.Map2(Yt.createPieChart,W.Map(function(oe){return oe[0]},M.expenseData().get_View()),W.Map(function(oe){return oe[1]},M.expenseData().get_View())),p=W.Map2(function(oe,ge){return Yt.createBalanceChart(w.Number(oe),w.Number(ge))},l,c),($=(g=(C=(S=ae.EmbedView(h),D=(q=(F=ae.EmbedView(d),I=(P=(b=ae.EmbedView(p),j=(k=(U=(O=(H=(V=(z=new dt.New$1,z.h.push(new _e.New("headerspa","Money Tracking")),z),V.h.push(new gt.New("categoryincome",M.categoryIncome())),V),H.h.push(new at.New("amountincome",M.amountIncome())),H),O.h.push(new gt.New("categoryexpenses",M.categoryExpenses())),O),U.h.push(new at.New("amountexpenses",M.amountExpenses())),U),k.h.push(new Qe.New("balance",a)),k),j.h.push(new Je.New("balancechart",b)),j),P.h.push(new Qe.New("expenses",c)),P),I.h.push(new Je.New("expenseschart",F)),I),q.h.push(new Qe.New("income",l)),q),D.h.push(new Je.New("incomechart",S)),D),C.h.push(nt.EventQ2(C.k,"addincome",function(){return C.i},function(){M.categoryIncome().Get()!=""&&M.amountIncome().Get()!==0?ne():M.emptyAlert()})),C),g.h.push(nt.EventQ2(g.k,"addexpense",function(){return g.i},function(){M.categoryExpenses().Get()!=""&&M.amountExpenses().Get()!==0?$e():M.emptyAlert()})),g),J=nt.CompleteHoles($.k,$.h,[["categoryincome",0,null],["amountincome",1,null],["categoryexpenses",0,null],["amountexpenses",1,null]]),X=new $t.New(J[1],It.moneytracking(J[0])),$.i=X,X).get_Doc()},M.stockData=function(){return y.$cctor(),y.stockData},M.startUpdatingLastPrices=function(){G.Start(G.Delay(function(){return G.While(function(){return!0},G.Delay(function(){return G.Bind(G.Sleep(3e3),function(){return M.updateLastPrices(),G.Zero()})}))}),null)},M.stockModel=function(){return y.$cctor(),y.stockModel},M.stockPrice=function(){return y.$cctor(),y.stockPrice},M.stockAmount=function(){return y.$cctor(),y.stockAmount},M.stockName=function(){return y.$cctor(),y.stockName},M.capitalize=function(a){var l;return(l=a[0],w.String(l)).toUpperCase()+a.substring(1).toLowerCase()},M.emptyAlert=function(){w.alert("Field can not be left empty.")},M.totalIncome=function(){return y.$cctor(),y.totalIncome},M.totalExpenses=function(){return y.$cctor(),y.totalExpenses},M.amountExpenses=function(){return y.$cctor(),y.amountExpenses},M.categoryExpenses=function(){return y.$cctor(),y.categoryExpenses},M.amountIncome=function(){return y.$cctor(),y.amountIncome},M.categoryIncome=function(){return y.$cctor(),y.categoryIncome},M.expenseData=function(){return y.$cctor(),y.expenseData},M.incomeData=function(){return y.$cctor(),y.incomeData},M.updateLastPrices=function(){M.stockModel().Iter(function(a){var l;l=M.randomStockLastPrice(a.Price),a.LastPrice=l,M.stockModel().UpdateBy(function(c){return{$:1,$0:St.New(c.Name,c.Amount,c.Price,l)}},a.Name)})},He.Create=function(a,l){return He.CreateWithStorage(a,Qt.InMemory(m.ofSeq(l)))},He.CreateWithStorage=function(a,l){return new He.New(a,l)},he.FailWith=function(a){throw new _n(a)},he.KeyValue=function(a){return[a.K,a.V]},he.range=function(a,l){var c;return c=1+l-a,c<=0?[]:R.init(c,function(h){return h+a})},He=x.ListModel=E.Class({RemoveByKey:function(a){var l;l=this,this.var.Set(this.storage.SRemoveIf(function(c){return _.Equals(l.key(c),a)},this.var.Get())),this.ObsoleteKey(a)},ObsoleteKey:function(a){var l,c;l=(c=null,[this.it.TryGetValue(a,{get:function(){return c},set:function(h){c=h}}),c]),l[0]&&(T.Obsolete(l[1]),this.it.RemoveKey(a))},Append:function(a){var l,c,h,d;l=this,c=this.var.Get(),h=this.key(a),d=m.tryFindIndex(function(p){return _.Equals(l.key(p),h)},c),d!=null&&d.$==1?this.var.Set(this.storage.SSetAt(d.$0,a,c)):this.var.Set(this.storage.SAppend(a,c)),this.ObsoleteKey(h)},Iter:function(a){m.iter(a,this.var.Get())},UpdateBy:function(a,l){var c,h,d,p,$;c=this,h=this.var.Get(),d=m.tryFindIndex(function(g){return _.Equals(c.key(g),l)},h),d!=null&&d.$==1&&(p=d.$0,$=a(m.get(h,p)),$!=null&&$.$==1&&(this.var.Set(this.storage.SSetAt(p,$.$0,h)),this.ObsoleteKey(l)))},GetEnumerator:function(){return Y.Get(this.var.Get())},GetEnumerator0:function(){return Y.Get0(this.var.Get())}},L,He),He.New=E.Ctor(function(a,l){He.New$3.call(this,a,ie.Create$1(m.ofSeq(R.distinctBy(a,l.SInit()))),l)},He),He.New$3=E.Ctor(function(a,l,c){L.New.call(this),this.key=a,this.var=l,this.storage=c,this.v=W.Map(function(h){return h.slice()},this.var.get_View()),this.it=new Ne.New$5},He),W.Sink=function(a,l){function c(){T.WhenRun(l(),a,function(){G.scheduler().Fork(c)})}G.scheduler().Fork(c)},W.Map=function(a,l){return W.CreateLazy(function(){return T.Map(a,l())})},W.Map2=function(a,l,c){return W.CreateLazy(function(){return T.Map2(a,l(),c())})},W.GetAsync=function(a){return G.FromContinuations(function(l){return W.Get(l,a)})},W.CreateLazy=function(a){var l;return l={c:null,o:a},function(){var c,h;return c=l.c,c===null&&(c=l.o(),l.c=c,h=c.s,h!=null&&h.$==0?l.o=null:T.WhenObsoleteRun(c,function(){l.c=null})),c}},W.Get=function(a,l){var c;function h(){T.WhenRun(l(),function(d){c[0]||(c[0]=!0,a(d))},function(){c[0]||h()})}c=[!1],h()},W.Bind=function(a,l){return W.Join(W.Map(a,l))},W.Join=function(a){return W.CreateLazy(function(){return T.Join(a())})},W.MapSeqCached=function(a,l){return W.MapSeqCachedBy(w.id,a,l)},W.MapSeqCachedBy=function(a,l,c){var h;return h=[new Ne.New$5],W.Map(function(d){var p,$,g;return p=h[0],$=new Ne.New$5,g=Pe.mapInPlace(function(C){var S,D;return S=a(C),D=p.ContainsKey(S)?p.Item(S):l(C),$.set_Item(S,D),D},m.ofSeq(d)),h[0]=$,g},c)},W.Const=function(a){var l;return l=T.New({$:0,$0:a}),function(){return l}},W.Map3=function(a,l,c,h){return W.CreateLazy(function(){return T.Map3(a,l(),c(),h())})},W.Sequence=function(a){return W.CreateLazy(function(){return T.Sequence(R.map(function(l){return l()},a))})},W.Map2Unit=function(a,l){return W.CreateLazy(function(){return T.Map2Unit(a(),l())})},Rn.r=function(){return vn.JSUnion(void 0,[[null,[[null,[]]],[]],[null,[[null,["stockPortfolio"]]],[]]])},It.stocklist=function(a){return B.LoadLocalTemplates("index"),a?B.NamedTemplate("index",{$:1,$0:"stocklist"},a):void 0},It.stockportfolio=function(a){return B.LoadLocalTemplates("index"),a?B.NamedTemplate("index",{$:1,$0:"stockportfolio"},a):void 0},It.moneytracking=function(a){return B.LoadLocalTemplates("index"),a?B.NamedTemplate("index",{$:1,$0:"moneytracking"},a):void 0},ht.InstallHash=function(a,l){var c;return c=ie.Create$1(void 0),ht.InstallHashInto(c,a,l),c},ht.InstallHashInto=function(a,l,c){function h($){return pt.Parse(c,fe.FromHash($,{$:1,$0:!0}))}function d(){return ht.getCurrentHash(h,l)}function p($){_.Equals(a.Get(),$)||a.Set($)}p(d()),self.addEventListener("popstate",function(){return p(d())},!1),self.addEventListener("hashchange",function(){return p(d())},!1),self.document.body.addEventListener("click",function($){var g,C,S;return g=(C=ht.findLinkHref($.target),C==null?null:(S=C.$0,re.StartsWith(S,"#")?h(S):null)),g==null?null:(p(g.$0),$.preventDefault())},!1),W.Sink(function($){var g;_.Equals($,d())||(g=pt.HashLink(c,$),self.history.pushState(null,null,g))},a.get_View())},ht.getCurrentHash=function(a,l){var c,h;return c=self.location.hash,h=a(c),h==null?(function(d){return function(p){return d("Failed to parse route: "+kn.toSafe(p))}}(function(d){ke.log(d)})(c),l):h.$0},ht.findLinkHref=function(a){for(;;){if(a.tagName=="A")return yn.ofObj(a.getAttribute("href"));if(a===self.document.body)return null;a=a.parentNode}},m.get=function(a,l){return m.checkBounds(a,l),a[l]},m.length=function(a){return a.dims===2?a.length*a.length:a.length},m.checkBounds=function(a,l){(l<0||l>=a.length)&&he.FailWith("Index was outside the bounds of the array.")},m.set=function(a,l,c){m.checkBounds(a,l),a[l]=c},dt=Ge.ProviderBuilder=E.Class({},L,dt),dt.New$1=E.Ctor(function(){var a;L.New.call(this),this.i=null,this.k=(a=Bn.NewGuid(),w.String(a)),this.h=E.MarkResizable([]),E.SetOptional(this,"s",null)},dt),de=x.TemplateHole=E.Class({ForTextView:function(){return ke.warn("Content hole filled with attribute data",this.get_Name()),null},AddAttribute:function(a,l){ke.warn("Var hole filled with non-Var data",this.get_Name())},get_AsChoiceView:function(){return ke.warn("Attribute value hole filled with non-text data",this.get_Name()),{$:0,$0:""}}},L,de),de.New=E.Ctor(function(){L.New.call(this)},de),W=x.View=E.Class({get_V:function(){return he.FailWith("View<'T>.V can only be called in an argument to a V-enabled function or if 'T = Doc.")}},null,W),bt=x.Var=E.Class({},L,bt),bt.New=E.Ctor(function(){L.New.call(this)},bt),zt=x.ConcreteVar=E.Class({get_View:function(){return this.view},Get:function(){return this.current},Set:function(a){this.isConst?function(l){return l("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal")}(function(l){ke.log(l)}):(T.Obsolete(this.snap),this.current=a,this.snap=T.New({$:2,$0:a,$1:[]}))},SetFinal:function(a){this.isConst?function(l){return l("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal")}(function(l){ke.log(l)}):(T.Obsolete(this.snap),this.isConst=!0,this.current=a,this.snap=T.New({$:0,$0:a}))},UpdateMaybe:function(a){var l;l=a(this.Get()),l!=null&&l.$==1&&this.Set(l.$0)}},bt,zt),zt.New=E.Ctor(function(a,l,c){var h;h=this,bt.New.call(this),this.isConst=a,this.current=c,this.snap=l,this.view=function(){return h.snap},this.id=ze.Int()},zt),T.WhenRun=function(a,l,c){var h;h=a.s,h==null?c():h!=null&&h.$==2?(h.$1.push(c),l(h.$0)):h!=null&&h.$==3?(h.$0.push(l),h.$1.push(c)):l(h.$0)},T.Map=function(a,l){var c,h;return c=l.s,c!=null&&c.$==0?T.New({$:0,$0:a(c.$0)}):(h=T.New({$:3,$0:[],$1:[]}),T.When(l,function(d){T.MarkDone(h,l,a(d))},h),h)},T.Map2=function(a,l,c){var h,d,p;function $(g){var C,S,D;C=p.s,!(C!=null&&C.$==0||C!=null&&C.$==2)&&(S=T.ValueAndForever(l),D=T.ValueAndForever(c),S!=null&&S.$==1&&D!=null&&D.$==1&&(S.$0[1]&&D.$0[1]?T.MarkForever(p,a(S.$0[0],D.$0[0])):T.MarkReady(p,a(S.$0[0],D.$0[0]))))}return h=l.s,d=c.s,h!=null&&h.$==0?d!=null&&d.$==0?T.New({$:0,$0:a(h.$0,d.$0)}):T.Map2Opt1(a,h.$0,c):d!=null&&d.$==0?T.Map2Opt2(a,d.$0,l):(p=T.New({$:3,$0:[],$1:[]}),T.When(l,$,p),T.When(c,$,p),p)},T.WhenObsoleteRun=function(a,l){var c;c=a.s,c==null?l():(c!=null&&c.$==2||c!=null&&c.$==3)&&c.$1.push(l)},T.When=function(a,l,c){var h;h=a.s,h==null?T.Obsolete(c):h!=null&&h.$==2?(T.EnqueueSafe(h.$1,c),l(h.$0)):h!=null&&h.$==3?(h.$0.push(l),T.EnqueueSafe(h.$1,c)):l(h.$0)},T.MarkDone=function(a,l,c){var h;h=l.s,h!=null&&h.$==0?T.MarkForever(a,c):T.MarkReady(a,c)},T.Map2Opt1=function(a,l,c){return T.Map(function(h){return a(l,h)},c)},T.Map2Opt2=function(a,l,c){return T.Map(function(h){return a(h,l)},c)},T.ValueAndForever=function(a){var l;return l=a.s,l!=null&&l.$==0?{$:1,$0:[l.$0,!0]}:l!=null&&l.$==2?{$:1,$0:[l.$0,!1]}:null},T.MarkForever=function(a,l){var c,h,d,p;if(c=a.s,c!=null&&c.$==3)for(a.s={$:0,$0:l},h=c.$0,d=0,p=m.length(h)-1;d<=p;d++)m.get(h,d)(l)},T.MarkReady=function(a,l){var c,h,d,p;if(c=a.s,c!=null&&c.$==3)for(a.s={$:2,$0:l,$1:c.$1},h=c.$0,d=0,p=m.length(h)-1;d<=p;d++)m.get(h,d)(l)},T.EnqueueSafe=function(a,l){var c,h,d,p;if(a.push(l),a.length%20===0)for(c=a.slice(0),ur.Clear(a),h=0,d=m.length(c)-1;h<=d;h++)p=m.get(c,h),typeof p=="object"?function($){$.s&&a.push($)}(p):function($){a.push($)}(p)},T.Join=function(a){var l;return l=T.New({$:3,$0:[],$1:[]}),T.When(a,function(c){var h;h=c(),T.When(h,function(d){var p,$;p=h.s,p!=null&&p.$==0&&($=a.s,$!=null&&$.$==0)?T.MarkForever(l,d):T.MarkReady(l,d)},l)},l),l},T.Map3=function(a,l,c,h){var d,p,$,g;function C(S){var D,q,F,I;D=g.s,!(D!=null&&D.$==0||D!=null&&D.$==2)&&(q=T.ValueAndForever(l),F=T.ValueAndForever(c),I=T.ValueAndForever(h),q!=null&&q.$==1&&F!=null&&F.$==1&&I!=null&&I.$==1&&(q.$0[1]&&F.$0[1]&&I.$0[1]?T.MarkForever(g,a(q.$0[0],F.$0[0],I.$0[0])):T.MarkReady(g,a(q.$0[0],F.$0[0],I.$0[0]))))}return d=l.s,p=c.s,$=h.s,d!=null&&d.$==0?p!=null&&p.$==0?$!=null&&$.$==0?T.New({$:0,$0:a(d.$0,p.$0,$.$0)}):T.Map3Opt1(a,d.$0,p.$0,h):$!=null&&$.$==0?T.Map3Opt2(a,d.$0,$.$0,c):T.Map3Opt3(a,d.$0,c,h):p!=null&&p.$==0?$!=null&&$.$==0?T.Map3Opt4(a,p.$0,$.$0,l):T.Map3Opt5(a,p.$0,l,h):$!=null&&$.$==0?T.Map3Opt6(a,$.$0,l,c):(g=T.New({$:3,$0:[],$1:[]}),T.When(l,C,g),T.When(c,C,g),T.When(h,C,g),g)},T.Sequence=function(a){var l,c,h;function d(p){var $;h[0]===0?($=m.map(function(g){var C;return C=g.s,C!=null&&C.$==0||C!=null&&C.$==2?C.$0:he.FailWith("value not found by View.Sequence")},l),m.forall(function(g){var C;return C=g.s,C!=null&&C.$==0},l)?T.MarkForever(c,$):T.MarkReady(c,$)):h[0]=h[0]-1}return l=m.ofSeq(a),l.length==0?T.New({$:0,$0:[]}):(c=T.New({$:3,$0:[],$1:[]}),h=[m.length(l)-1],m.iter(function(p){T.When(p,d,c)},l),c)},T.Map2Unit=function(a,l){var c,h,d;function p(){var $,g,C;$=d.s,!($!=null&&$.$==0||$!=null&&$.$==2)&&(g=T.ValueAndForever(a),C=T.ValueAndForever(l),g!=null&&g.$==1&&C!=null&&C.$==1&&(g.$0[1]&&C.$0[1]?T.MarkForever(d,null):T.MarkReady(d,null)))}return c=a.s,h=l.s,c!=null&&c.$==0?h!=null&&h.$==0?T.New({$:0,$0:null}):l:h!=null&&h.$==0?a:(d=T.New({$:3,$0:[],$1:[]}),T.When(a,p,d),T.When(l,p,d),d)},T.Copy=function(a){var l,c,h;return l=a.s,l==null?a:l!=null&&l.$==2?(c=T.New({$:2,$0:l.$0,$1:[]}),T.WhenObsolete(a,c),c):l!=null&&l.$==3?(h=T.New({$:3,$0:[],$1:[]}),T.When(a,function(d){T.MarkDone(h,a,d)},h),h):a},T.Map3Opt1=function(a,l,c,h){return T.Map(function(d){return a(l,c,d)},h)},T.Map3Opt2=function(a,l,c,h){return T.Map(function(d){return a(l,d,c)},h)},T.Map3Opt3=function(a,l,c,h){return T.Map2(function(d,p){return a(l,d,p)},c,h)},T.Map3Opt4=function(a,l,c,h){return T.Map(function(d){return a(d,l,c)},h)},T.Map3Opt5=function(a,l,c,h){return T.Map2(function(d,p){return a(d,l,p)},c,h)},T.Map3Opt6=function(a,l,c,h){return T.Map2(function(d,p){return a(d,p,l)},c,h)},T.WhenObsolete=function(a,l){var c;c=a.s,c==null?T.Obsolete(l):(c!=null&&c.$==2||c!=null&&c.$==3)&&T.EnqueueSafe(c.$1,l)},Vt=N.Random=E.Class({Next:function(a,l){return a>l?he.FailWith("'minValue' cannot be greater than maxValue."):a+An.floor(An.random()*(l-a))}},L,Vt),Vt.New=E.Ctor(function(){L.New.call(this)},Vt),Qt.InMemory=function(a){return new en.New(a)},R.sumBy=function(a,l){var c,h;c=0,h=Y.Get(l);try{for(;h.MoveNext();)c=c+a(h.Current())}finally{typeof h=="object"&&"Dispose"in h&&h.Dispose()}return c},R.iteri=function(a,l){var c,h;c=0,h=Y.Get(l);try{for(;h.MoveNext();)a(c,h.Current()),c=c+1}finally{typeof h=="object"&&"Dispose"in h&&h.Dispose()}},R.collect=function(a,l){return R.concat(R.map(a,l))},R.append=function(a,l){return{GetEnumerator:function(){var c,h;return c=Y.Get(a),h=[!0],new be.New(c,null,function(d){var p;return d.s.MoveNext()?(d.c=d.s.Current(),!0):(p=d.s,_.Equals(p,null)||p.Dispose(),d.s=null,h[0]&&(h[0]=!1,d.s=Y.Get(l),d.s.MoveNext()?(d.c=d.s.Current(),!0):(d.s.Dispose(),d.s=null,!1)))},function(d){var p;p=d.s,_.Equals(p,null)||p.Dispose()})}}},R.indexed=function(a){return R.mapi(function(l,c){return[l,c]},a)},R.map=function(a,l){return{GetEnumerator:function(){var c;return c=Y.Get(l),new be.New(null,null,function(h){return c.MoveNext()&&(h.c=a(c.Current()),!0)},function(){c.Dispose()})}}},R.tryFindIndex=function(a,l){var c,h,d;c=Y.Get(l);try{for(h=!0,d=0;h&&c.MoveNext();)a(c.Current())?h=!1:d=d+1;return h?null:{$:1,$0:d}}finally{typeof c=="object"&&"Dispose"in c&&c.Dispose()}},R.tryPick=function(a,l){var c,h;c=Y.Get(l);try{for(h=null;_.Equals(h,null)&&c.MoveNext();)h=a(c.Current());return h}finally{typeof c=="object"&&"Dispose"in c&&c.Dispose()}},R.distinctBy=function(a,l){return{GetEnumerator:function(){var c,h;return c=Y.Get(l),h=new Ce.New$3,new be.New(null,null,function(d){var p,$;if(c.MoveNext()){for(p=c.Current(),$=h.SAdd(a(p));!$&&c.MoveNext();)p=c.Current(),$=h.SAdd(a(p));return $&&(d.c=p,!0)}else return!1},function(){c.Dispose()})}}},R.concat=function(a){return{GetEnumerator:function(){var l;function c(h){for(var d;;)if(d=h.s,_.Equals(d,null))if(l.MoveNext())h.s=Y.Get(l.Current()),h=h;else return l.Dispose(),!1;else{if(d.MoveNext())return h.c=d.Current(),!0;h.Dispose(),h.s=null,h=h}}return l=Y.Get(a),new be.New(null,null,c,function(h){var d;d=h.s,_.Equals(d,null)||d.Dispose(),_.Equals(l,null)||l.Dispose()})}}},R.mapi=function(a,l){return R.map2(a,R.initInfinite(w.id),l)},R.map2=function(a,l,c){return{GetEnumerator:function(){var h,d;return h=Y.Get(l),d=Y.Get(c),new be.New(null,null,function(p){return h.MoveNext()&&d.MoveNext()&&(p.c=a(h.Current(),d.Current()),!0)},function(){h.Dispose(),d.Dispose()})}}},R.initInfinite=function(a){return{GetEnumerator:function(){return new be.New(0,null,function(l){return l.c=a(l.s),l.s=l.s+1,!0},void 0)}}},R.head=function(a){var l;l=Y.Get(a);try{return l.MoveNext()?l.Current():R.insufficient()}finally{typeof l=="object"&&"Dispose"in l&&l.Dispose()}},R.forall2=function(a,l,c){return!R.exists2(function(h,d){return!a(h,d)},l,c)},R.rev=function(a){return R.delay(function(){return m.ofSeq(a).slice().reverse()})},R.fold=function(a,l,c){var h,d;h=l,d=Y.Get(c);try{for(;d.MoveNext();)h=a(h,d.Current());return h}finally{typeof d=="object"&&"Dispose"in d&&d.Dispose()}},R.exists2=function(a,l,c){var h,d,p,$;h=Y.Get(l);try{p=Y.Get(c);try{for($=!1;!$&&h.MoveNext()&&p.MoveNext();)$=a(h.Current(),p.Current());d=$}finally{typeof p=="object"&&"Dispose"in p&&p.Dispose()}return d}finally{typeof h=="object"&&"Dispose"in h&&h.Dispose()}},R.delay=function(a){return{GetEnumerator:function(){return Y.Get(a())}}},R.distinct=function(a){return R.distinctBy(w.id,a)},R.iter=function(a,l){var c;c=Y.Get(l);try{for(;c.MoveNext();)a(c.Current())}finally{typeof c=="object"&&"Dispose"in c&&c.Dispose()}},R.unfold=function(a,l){return{GetEnumerator:function(){return new be.New(l,null,function(c){var h;return h=a(c.s),h==null?!1:(c.c=h.$0[0],c.s=h.$0[1],!0)},void 0)}}},R.max=function(a){var l,c,h;l=Y.Get(a);try{for(l.MoveNext()||R.seqEmpty(),c=l.Current();l.MoveNext();)h=l.Current(),_.Compare(h,c)===1&&(c=h);return c}finally{typeof l=="object"&&"Dispose"in l&&l.Dispose()}},R.init=function(a,l){return R.take(a,R.initInfinite(l))},R.seqEmpty=function(){return he.FailWith("The input sequence was empty.")},R.compareWith=function(a,l,c){var h,d,p,$,g;h=Y.Get(l);try{p=Y.Get(c);try{for($=0,g=!0;g&&$===0;)h.MoveNext()?$=p.MoveNext()?a(h.Current(),p.Current()):1:p.MoveNext()?$=-1:g=!1;d=$}finally{typeof p=="object"&&"Dispose"in p&&p.Dispose()}return d}finally{typeof h=="object"&&"Dispose"in h&&h.Dispose()}},R.forall=function(a,l){return!R.exists(function(c){return!a(c)},l)},R.take=function(a,l){return a<0&&R.nonNegative(),{GetEnumerator:function(){var c;return c=[Y.Get(l)],new be.New(0,null,function(h){var d;return h.s=h.s+1,h.s>a?!1:(d=c[0],_.Equals(d,null)?R.insufficient():d.MoveNext()?(h.c=d.Current(),h.s===a&&(d.Dispose(),c[0]=null),!0):(d.Dispose(),c[0]=null,R.insufficient()))},function(){var h;h=c[0],_.Equals(h,null)||h.Dispose()})}}},R.exists=function(a,l){var c,h;c=Y.Get(l);try{for(h=!1;!h&&c.MoveNext();)h=a(c.Current());return h}finally{typeof c=="object"&&"Dispose"in c&&c.Dispose()}},G.Delay=function(a){return function(l){try{a(null)(l)}catch(c){l.k({$:1,$0:c})}}},G.While=function(a,l){return a()?G.Bind(l,function(){return G.While(a,l)}):G.Return()},G.Bind=function(a,l){return G.checkCancel(function(c){a(xn.New(function(h){var d;h.$==0?(d=h.$0,G.scheduler().Fork(function(){try{l(d)(c)}catch(p){c.k({$:1,$0:p})}})):G.scheduler().Fork(function(){c.k(h)})},c.ct))})},G.Sleep=function(a){return function(l){var c,h;c=void 0,h=void 0,c=w.setTimeout(function(){h.Dispose(),G.scheduler().Fork(function(){l.k({$:0,$0:null})})},a),h=G.Register(l.ct,function(){w.clearTimeout(c),G.scheduler().Fork(function(){G.cancel(l)})})}},G.Zero=function(){return Ve.$cctor(),Ve.Zero},G.Start=function(a,l){var c,h;c=(h=G.defCTS()[0],l==null?h:l.$0),G.scheduler().Fork(function(){c.c||a(xn.New(function(d){d.$==1&&G.UncaughtAsyncError(d.$0)},c))})},G.scheduler=function(){return Ve.$cctor(),Ve.scheduler},G.Return=function(a){return function(l){l.k({$:0,$0:a})}},G.checkCancel=function(a){return function(l){l.ct.c?G.cancel(l):a(l)}},G.Register=function(a,l){var c;return a===G.noneCT()?{Dispose:function(){return null}}:(c=a.r.push(l)-1,{Dispose:function(){return m.set(a.r,c,w.ignore)}})},G.cancel=function(a){a.k({$:2,$0:new lt.New(a.ct)})},G.FromContinuations=function(a){return function(l){var c;function h(d){c[0]?he.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times"):(c[0]=!0,G.scheduler().Fork(d))}c=[!1],a(function(d){h(function(){l.k({$:0,$0:d})})},function(d){h(function(){l.k({$:1,$0:d})})},function(d){h(function(){l.k({$:2,$0:d})})})}},G.defCTS=function(){return Ve.$cctor(),Ve.defCTS},G.UncaughtAsyncError=function(a){ke.log("WebSharper: Uncaught asynchronous exception",a)},G.noneCT=function(){return Ve.$cctor(),Ve.noneCT},qn.GetFieldValues=function(a){var l;l=[];for(var c in a)l.push(a[c]);return l},At.EncodeList=E.Curried3(function(a,l,c){var h,d;return h=[],d=a(),K.iter(function(p){h.push(d(p))},c),h}),At.Id=E.Curried3(function(a,l,c){return c}),At.DecodeList=E.Curried3(function(a,l,c){var h;return h=a(),K.init(m.length(c),function(d){return h(m.get(c,d))})}),fr.NewFromSeq=function(a){var l,c,h;l={},c=Y.Get(a);try{for(;c.MoveNext();)h=c.Current(),l[h[0]]=h[1]}finally{typeof c=="object"&&"Dispose"in c&&c.Dispose()}return l},Y.Get=function(a){return a instanceof w.Array?Y.ArrayEnumerator(a):_.Equals(typeof a,"string")?Y.StringEnumerator(a):a.GetEnumerator()},Y.ArrayEnumerator=function(a){return new be.New(0,null,function(l){var c;return c=l.s,c<m.length(a)&&(l.c=m.get(a,c),l.s=c+1,!0)},void 0)},Y.StringEnumerator=function(a){return new be.New(0,null,function(l){var c;return c=l.s,c<a.length&&(l.c=a[c],l.s=c+1,!0)},void 0)},Y.Get0=function(a){return a instanceof w.Array?Y.ArrayEnumerator(a):_.Equals(typeof a,"string")?Y.StringEnumerator(a):"GetEnumerator0"in a?a.GetEnumerator0():a.GetEnumerator()},vn.JSUnion=function(a,l){var c;function h(g){var C;function S(D){return D!=null&&D.$==1&&_.Equals(g,D.$0)}return C=R.tryFindIndex(function(D){return S(D[0])},l),C!=null&&C.$==1?C.$0:g.$}function d(g,C){return m.init(m.length(m.get(l,g)[2]),function(S){return C["$"+w.String(S)]})}function p(g,C){var S,D,q;return S=a==null?{}:new a,D=m.get(l,g),q=D[0],q!=null&&q.$==1?D[0].$0:(S.$=g,R.iteri(function(F,I){S["$"+w.String(F)]=I},C),S)}function $(g,C){var S;function D(q,F){return[g,q,F,S]}return S=C[2],R.map(function(q){return D(q[0],q[1])},C[1])}return c=m.ofSeq(R.collect(function(g){return $(g[0],g[1])},R.indexed(l))),Kn.New$1(function(g){function C(S,D,q,F){var I,P,b;function j(k){return function(U){return function(O){var H;function V(z,J){return j(H)(z)(new le({$:1,$0:J,$1:O}))}return k.$==1?(H=k.$1,R.collect(function(z){return V(z[0],z[1])},k.$0.Parse(U))):[[U,p(S,m.ofList(K.rev(O)))]]}}}return vn.isCorrectMethod(D,g.Method)?(I=En.startsWith(K.ofArray(q),g.Segments),I==null?[]:(P=I.$0,b=K.ofArray(F),b.$==0?[[fe.New(P,g.QueryArgs,g.FormData,g.Method,g.Body),p(S,[])]]:j(b)(fe.New(P,g.QueryArgs,g.FormData,g.Method,g.Body))(le.Empty))):[]}return R.collect(function(S){return C(S[0],S[1],S[2],S[3])},c)},function(g){var C,S,D,q,F,I;function P(b,j){return j.Write(b)}return C=h(g),S=m.get(l,C),D=S[2],q=m.get(S[1],0),F=[fe.Segment(K.ofArray(q[1]),q[0])],D.length==0?{$:1,$0:F}:(I=E.Curried3(m.map2)(P)(d(C,g))(D),m.forall(function(b){return b!=null},I)?{$:1,$0:R.append(F,R.collect(function(b){return b.$0},I))}:null)})},vn.isCorrectMethod=function(a,l){return l!=null&&l.$==1?a!=null&&a.$==1?_.Equals(l.$0,a.$0):!0:!(a!=null&&a.$==1)},pt.Parse=function(a,l){function c(h,d){return h.Segments.$==0?{$:1,$0:d}:null}return R.tryPick(function(h){return c(h[0],h[1])},a.Parse(l))},pt.HashLink=function(a,l){return"#"+pt.Link(a,l)},pt.Link=function(a,l){var c;return c=pt.Write(a,l),c==null?"":c.$0.ToLink()},pt.Write=function(a,l){var c;return c=a.Write(l),c==null?null:{$:1,$0:fe.Combine(c.$0)}},fe=Oe.Route=E.Class({ToLink:function(){return qt.WriteLink(this.Segments,this.QueryArgs)}},null,fe),fe.FromHash=function(a,l){var c,h;return c=a.indexOf("#"),c===-1?fe.get_Empty():(h=a.substring(c+1),l!=null&&l.$0?h==""||h=="/"?fe.get_Empty():re.StartsWith(h,"/")?fe.FromUrl(h.substring(1),{$:1,$0:!0}):fe.Segment$2(h):fe.FromUrl(a.substring(c),{$:1,$0:!1}))},fe.Segment=function(a,l){var c;return c=fe.get_Empty(),fe.New(a,c.QueryArgs,c.FormData,l,c.Body)},fe.get_Empty=function(){return fe.New(le.Empty,new Le.New([]),new Le.New([]),null,{$:1,$0:null})},fe.FromUrl=function(a,l){var c,h,d;return c=(h=a.indexOf("?"),h===-1?[a,new Le.New([])]:[re.Substring(a,0,h),fe.ParseQuery(a.substring(h+1))]),d=fe.get_Empty(),fe.New(K.ofArray(re.SplitChars(c[0],["/"],l!=null&&l.$0?0:1)),c[1],d.FormData,d.Method,d.Body)},fe.Segment$2=function(a){var l;return l=fe.get_Empty(),fe.New(K.ofArray([a]),l.QueryArgs,l.FormData,l.Method,l.Body)},fe.ParseQuery=function(a){return Dt.OfArray(m.ofSeq(m.choose(function(l){var c,h;return c=re.SplitChars(l,["="],0),!_.Equals(c,null)&&c.length===2?(h=m.get(c,1),{$:1,$0:[m.get(c,0),h]}):(function(d){return function(p){return d("wrong format for query argument: "+kn.toSafe(p))}}(function(d){ke.log(d)})(l),null)},re.SplitChars(a,["&"],0))))},fe.Combine=function(a){var l,c,h,d,p,$,g;return l=m.ofSeq(a),c=m.length(l),c===0?fe.get_Empty():c===1?m.get(l,0):(h=null,d=null,p=[],$=new Le.New([]),g=new Le.New([]),m.iter(function(C){var S,D;S=C.Method,S!=null&&S.$==1&&(h=S),D=C.Body,D==null||(d=D),$=Dt.FoldBack(function(q,F,I){return I.Add$1(q,F)},$,C.QueryArgs),g=Dt.FoldBack(function(q,F,I){return I.Add$1(q,F)},g,C.FormData),K.iter(function(q){p.push(q)},C.Segments)},l),fe.New(K.ofSeq(p),$,g,h,d))},fe.New=function(a,l,c,h,d){return new fe({Segments:a,QueryArgs:l,FormData:c,Method:h,Body:d})},$t=Ge.TemplateInstance=E.Class({get_Doc:function(){return this.doc},SetAnchorRoot:function(a){this.anchorRoot=a}},L,$t),$t.New=E.Ctor(function(a,l){L.New.call(this),this.doc=l,this.allVars=a.$==0?a.$0:he.FailWith("Should not happen"),this.anchorRoot=null},$t),Je=ue.Elt=E.Class({get_Name:function(){return this.name},get_Value:function(){return this.fillWith}},de,Je),Je.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},Je),_e=ue.Text=E.Class({get_Name:function(){return this.name},get_Value:function(){return this.fillWith},get_AsChoiceView:function(){return{$:0,$0:this.fillWith}}},de,_e),_e.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},_e),_.Equals=function(a,l){var c,h;if(a===l)return!0;if(c=typeof a,c=="object"){if(a==null||l===null||l===void 0||!_.Equals(typeof l,"object"))return!1;if("Equals"in a)return a.Equals(l);if("Equals"in l)return!1;if(a instanceof w.Array&&l instanceof w.Array)return _.arrayEquals(a,l);if(a instanceof w.Date&&l instanceof w.Date)return _.dateEquals(a,l);h=[!0];for(var d in a)if(function($){return h[0]=!a.hasOwnProperty($)||l.hasOwnProperty($)&&_.Equals(a[$],l[$]),!h[0]}(d))break;if(h[0]){for(var p in l)if(function($){return h[0]=!l.hasOwnProperty($)||a.hasOwnProperty($),!h[0]}(p))break}return h[0]}else return c=="function"&&("$Func"in a?a.$Func===l.$Func&&a.$Target===l.$Target:"$Invokes"in a&&"$Invokes"in l&&_.arrayEquals(a.$Invokes,l.$Invokes))},_.arrayEquals=function(a,l){var c,h;if(m.length(a)===m.length(l)){for(c=!0,h=0;c&&h<m.length(a);)_.Equals(m.get(a,h),m.get(l,h))||(c=!1),h=h+1;return c}else return!1},_.dateEquals=function(a,l){return a.getTime()===l.getTime()},_.Hash=function(a){var l;return l=typeof a,l=="function"?0:l=="boolean"?a?1:0:l=="number"?a:l=="string"?_.hashString(a):l=="object"?a==null?0:a instanceof w.Array?_.hashArray(a):_.hashObject(a):0},_.hashString=function(a){var l,c,h;if(a===null)return 0;for(l=5381,c=0,h=a.length-1;c<=h;c++)l=_.hashMix(l,a[c].charCodeAt());return l},_.hashArray=function(a){var l,c,h;for(l=-34948909,c=0,h=m.length(a)-1;c<=h;c++)l=_.hashMix(l,_.Hash(m.get(a,c)));return l},_.hashObject=function(a){var l;if("GetHashCode"in a)return a.GetHashCode();l=[0];for(var c in a)(function(h){return l[0]=_.hashMix(_.hashMix(l[0],_.hashString(h)),_.Hash(a[h])),!1})(c);return l[0]},_.hashMix=function(a,l){return(a<<5)+a+l},_.Compare=function(a,l){var c,h,d;if(a===l)return 0;switch(c=typeof a,c=="function"?1:c=="boolean"||c=="number"||c=="string"?2:c=="object"?3:0){case 0:return typeof l>"u"?0:-1;case 1:return he.FailWith("Cannot compare function values.");case 2:return a<l?-1:1;case 3:if(a===null)h=-1;else if(l===null)h=1;else if("CompareTo"in a)h=a.CompareTo(l);else if("CompareTo0"in a)h=a.CompareTo0(l);else if(a instanceof w.Array&&l instanceof w.Array)h=_.compareArrays(a,l);else if(a instanceof w.Date&&l instanceof w.Date)h=_.compareDates(a,l);else{d=[0];for(var p in a)if(function(g){return a.hasOwnProperty(g)?l.hasOwnProperty(g)?(d[0]=_.Compare(a[g],l[g]),d[0]!==0):(d[0]=1,!0):!1}(p))break;if(d[0]===0){for(var $ in l)if(function(g){return l.hasOwnProperty(g)?!a.hasOwnProperty(g)&&(d[0]=-1,!0):!1}($))break}h=d[0]}return h}},_.compareArrays=function(a,l){var c,h;if(m.length(a)<m.length(l))return-1;if(m.length(a)>m.length(l))return 1;for(c=0,h=0;c===0&&h<m.length(a);)c=_.Compare(m.get(a,h),m.get(l,h)),h=h+1;return c},_.compareDates=function(a,l){return _.Compare(a.getTime(),l.getTime())},Bn.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new w.RegExp("[xy]","g"),function(a){var l,c;return l=An.random()*16|0,c=a=="x"?l:l&3|8,c.toString(16)})},Et=Zt.FSharpEvent=E.Class({},L,Et),Et.New=E.Ctor(function(){L.New.call(this),this.event=nn.New(E.MarkResizable([]))},Et),nt.EventQ2=function(a,l,c,h){return new Rt.New(l,function(d){return function(p){var $;return $=c(),$.SetAnchorRoot(d),h({Vars:$,Anchors:$,Target:d,Event:p})}})},nt.CompleteHoles=function(a,l,c){var h,d,p,$,g;function C(S,D,q){var F;return d.Contains(S)?null:(F=_.Equals(D,0)?Te.GetOrAddHoleFor(a,S,function(){return new gt.New(S,ie.Create$1(""))}):_.Equals(D,1)?Te.GetOrAddHoleFor(a,S,function(){return new at.New(S,ie.Create$1(0))}):_.Equals(D,2)?Te.GetOrAddHoleFor(a,S,function(){return new an.New(S,ie.Create$1(!1))}):_.Equals(D,3)?Te.GetOrAddHoleFor(a,S,function(){return new ln.New(S,ie.Create$1(-864e13))}):_.Equals(D,4)?Te.GetOrAddHoleFor(a,S,function(){return new cn.New(S,ie.Create$1([]))}):_.Equals(D,5)?Te.GetOrAddHoleFor(a,S,function(){var I;return I=self.document.querySelector("[ws-dom="+S+"]"),I.removeAttribute("ws-dom"),new Ut.New(S,ie.Create$1({$:1,$0:I}))}):he.FailWith("Invalid value type"),h.set_Item(S,F),{$:1,$0:F})}h=new Ne.New$5,d=new Ce.New$3,p=Y.Get(l);try{for(;p.MoveNext();)$=p.Current(),g=$.get_Name(),d.SAdd(g),h.set_Item(g,$)}finally{typeof p=="object"&&"Dispose"in p&&p.Dispose()}return[R.append(l,m.choose(function(S){return C(S[0],S[1],S[2])},c)),{$:0,$0:h}]},Xt.Render$8=function(a,l,c,h){var d;return Ee.RenderLineChart(a,(d=Tt.defaultSize(),l==null?d:l.$0),c,h)},Xt.Render$5=function(a,l,c,h){var d;return Ee.RenderPolarAreaChart(a,(d=Tt.defaultSize(),l==null?d:l.$0),{$:1,$0:c==null?{}:c.$0},h)},jn.Line=function(a){return new rn.New({$:1,$0:un.streamWithLabel(a)},me.defaultChartConfig(),me.defaultSeriesChartConfig(),me.defaultColorConfig())},Yt.createBalanceChart=function(a,l){return Xt.Render$5(Dn.Pie(K.zip(K.ofArray(["Total Income","Total Expenses"]),K.ofArray([a,l]))),{$:1,$0:{$:0,$0:300,$1:300}},null,null)},Yt.createPieChart=function(a,l){return Xt.Render$5(Dn.Pie(K.zip(a,l)),{$:1,$0:{$:0,$0:300,$1:300}},null,null)},ae=x.Doc=E.Class({},L,ae),ae.EmbedView=function(a){var l;return l=Z.CreateEmbedNode(),ae.Mk({$:2,$0:l},W.Map(w.ignore,W.Bind(function(c){return Z.UpdateEmbedNode(l,c.docNode),c.updates},a)))},ae.Mk=function(a,l){return new ae.New(a,l)},ae.Convert=function(a,l){return ae.Flatten(W.MapSeqCached(a,l))},ae.RunInPlace=function(a,l,c){var h;h=Z.CreateRunState(l,c.docNode),W.Sink(Ae.get_UseAnimations()||Mn.BatchUpdatesEnabled()?nr.StartProcessor(Z.PerformAnimatedUpdate(a,h,c.docNode)):function(){Z.PerformSyncUpdate(a,h,c.docNode)},c.updates)},ae.Flatten=function(a){return ae.EmbedView(W.Map(ae.Concat,a))},ae.get_Empty=function(){return ae.Mk(null,W.Const())},ae.Concat=function(a){var l;return l=Pe.ofSeqNonCopying(a),Pe.TreeReduce(ae.get_Empty(),ae.Append,l)},ae.TextNode=function(a){return ae.Mk({$:5,$0:self.document.createTextNode(a)},W.Const())},ae.TextView=function(a){var l;return l=Z.CreateTextNode(),ae.Mk({$:4,$0:l},W.Map(function(c){Z.UpdateTextNode(l,c)},a))},ae.Append=function(a,l){return ae.Mk({$:0,$0:a.docNode,$1:l.docNode},W.Map2Unit(a.updates,l.updates))},ae.Element=function(a,l,c){var h,d;return h=ye.Concat(l),d=ae.Concat(c),it.New(self.document.createElement(a),h,d)},ae.New=E.Ctor(function(a,l){L.New.call(this),this.docNode=a,this.updates=l},ae),ze.Int=function(){return ze.set_counter(ze.counter()+1),ze.counter()},ze.set_counter=function(a){xt.$cctor(),xt.counter=a},ze.counter=function(){return xt.$cctor(),xt.counter},en=Qt.ArrayStorage=E.Class({SRemoveIf:function(a,l){return m.filter(function(c){return!a(c)},l)},SInit:function(){return this.init},SSetAt:function(a,l,c){return m.set(c,a,l),c},SAppend:function(a,l){return l.push(a),l}},L,en),en.New=E.Ctor(function(a){L.New.call(this),this.init=a},en),m.ofSeq=function(a){var l,c;if(a instanceof w.Array)return a.slice();if(a instanceof le)return m.ofList(a);l=[],c=Y.Get(a);try{for(;c.MoveNext();)l.push(c.Current());return l}finally{typeof c=="object"&&"Dispose"in c&&c.Dispose()}},m.ofList=function(a){var l,c;for(c=[],l=a;l.$!=0;)c.push(K.head(l)),l=K.tail(l);return c},m.map2=function(a,l,c){var h,d,p;for(m.checkLength(l,c),h=new w.Array(c.length),d=0,p=c.length-1;d<=p;d++)h[d]=a(l[d],c[d]);return h},m.forall=function(a,l){var c,h,d;for(c=!0,h=0,d=m.length(l);c&&h<d;)a(l[h])?h=h+1:c=!1;return c},m.init=function(a,l){var c,h,d;for(a<0&&he.FailWith("Negative size given."),c=new w.Array(a),h=0,d=a-1;h<=d;h++)c[h]=l(h);return c},m.checkLength=function(a,l){a.length!==l.length&&he.FailWith("The arrays have different lengths.")},m.choose=function(a,l){var c,h,d,p;for(c=[],h=0,d=l.length-1;h<=d;h++)p=a(l[h]),p==null||c.push(p.$0);return c},m.tryFindIndex=function(a,l){var c,h;for(c=null,h=0;h<l.length&&c==null;)a(l[h])&&(c={$:1,$0:h}),h=h+1;return c},m.map=function(a,l){var c,h,d;for(c=new w.Array(l.length),h=0,d=l.length-1;h<=d;h++)c[h]=a(l[h]);return c},m.iter=function(a,l){var c,h;for(c=0,h=l.length-1;c<=h;c++)a(l[c])},m.iteri=function(a,l){var c,h;for(c=0,h=l.length-1;c<=h;c++)a(c,l[c])},m.tryPick=function(a,l){var c,h,d;for(c=null,h=0;h<l.length&&c==null;)d=a(l[h]),d!=null&&d.$==1&&(c=d),h=h+1;return c},m.concat=function(a){return w.Array.prototype.concat.apply([],m.ofSeq(a))},m.filter=function(a,l){var c,h,d;for(c=[],h=0,d=l.length-1;h<=d;h++)a(l[h])&&c.push(l[h]);return c},m.sortInPlace=function(a){m.mapInPlace(function(l){return l[0]},m.mapiInPlace(function(l,c){return[c,l]},a).sort(_.Compare))},m.exists=function(a,l){var c,h,d;for(c=!1,h=0,d=m.length(l);!c&&h<d;)a(l[h])?c=!0:h=h+1;return c},m.foldBack=function(a,l,c){var h,d,p,$;for(h=c,d=l.length,p=1,$=d;p<=$;p++)h=a(l[d-p],h);return h},m.pick=function(a,l){var c;return c=m.tryPick(a,l),c==null?he.FailWith("KeyNotFoundException"):c.$0},m.create=function(a,l){var c,h,d;for(c=new w.Array(a),h=0,d=a-1;h<=d;h++)c[h]=l;return c},Ne=pe.Dictionary=E.Class({set_Item:function(a,l){this.set(a,l)},TryGetValue:function(a,l){var c,h,d;return c=this,h=this.data[this.hash(a)],h==null?!1:(d=m.tryPick(function(p){var $;return $=he.KeyValue(p),c.equals.apply(null,[$[0],a])?{$:1,$0:$[1]}:null},h),d!=null&&d.$==1&&(l.set(d.$0),!0))},RemoveKey:function(a){return this.remove(a)},GetEnumerator:function(){return Y.Get0(m.concat(qn.GetFieldValues(this.data)))},set:function(a,l){var c,h,d,p;c=this,h=this.hash(a),d=this.data[h],d==null?(this.count=this.count+1,this.data[h]=new w.Array({K:a,V:l})):(p=m.tryFindIndex(function($){return c.equals.apply(null,[he.KeyValue($)[0],a])},d),p==null?(this.count=this.count+1,d.push({K:a,V:l})):d[p.$0]={K:a,V:l})},remove:function(a){var l,c,h,d;return l=this,c=this.hash(a),h=this.data[c],h==null?!1:(d=m.filter(function(p){return!l.equals.apply(null,[he.KeyValue(p)[0],a])},h),m.length(d)<h.length&&(this.count=this.count-1,this.data[c]=d,!0))},ContainsKey:function(a){var l,c;return l=this,c=this.data[this.hash(a)],c==null?!1:m.exists(function(h){return l.equals.apply(null,[he.KeyValue(h)[0],a])},c)},Item:function(a){return this.get(a)},Values:function(){return new pn.New(this)},Keys:function(){return new mn.New(this)},get:function(a){var l,c;return l=this,c=this.data[this.hash(a)],c==null?Xn.notPresent():m.pick(function(h){var d;return d=he.KeyValue(h),l.equals.apply(null,[d[0],a])?{$:1,$0:d[1]}:null},c)}},L,Ne),Ne.New$5=E.Ctor(function(){Ne.New$6.call(this,[],_.Equals,_.Hash)},Ne),Ne.New$6=E.Ctor(function(a,l,c){var h,d;L.New.call(this),this.equals=l,this.hash=c,this.count=0,this.data=[],h=Y.Get(a);try{for(;h.MoveNext();)d=h.Current(),this.set(d.K,d.V)}finally{typeof h=="object"&&"Dispose"in h&&h.Dispose()}},Ne),T.Obsolete=function(a){var l,c,h,d,p;if(c=a.s,!(c==null||(!(c!=null&&c.$==2||c!=null&&c.$==3)||(l=c.$1,!1))))for(a.s=null,h=0,d=m.length(l)-1;h<=d;h++)p=m.get(l,h),typeof p=="object"?function($){T.Obsolete($)}(p):p()},T.New=function(a){return{s:a}},Kn.New$1=function(a,l){return{Parse:a,Write:l}},En.startsWith=function(a,l){var c;switch(a.$==1?l.$==1&&_.Equals(a.$0,l.$0)?(c=[l.$0,l.$1,a.$0,a.$1],1):2:0){case 0:return{$:1,$0:l};case 1:return En.startsWith(c[3],c[1]);case 2:return null}},yn.ofObj=function(a){return a==null?null:{$:1,$0:a}},yn.fold=function(a,l,c){return c==null?l:a(l,c.$0)},Nn.TryParseInt32=function(a,l){return Nn.TryParse(a,-2147483648,2147483647,l)},Qe=ue.TextView=E.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:this.fillWith}},get_AsChoiceView:function(){return{$:1,$0:this.fillWith}}},de,Qe),Qe.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},Qe),at=ue.VarFloatUnchecked=E.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:W.Map(w.String,this.fillWith.get_View())}},AddAttribute:function(a,l){a(l)(se.FloatValueUnchecked(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:W.Map(w.String,this.fillWith.get_View())}}},de,at),at.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},at),gt=ue.VarStr=E.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:this.fillWith.get_View()}},AddAttribute:function(a,l){a(l)(se.Value(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:W.Map(w.String,this.fillWith.get_View())}}},de,gt),gt.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},gt),Rt=ue.EventQ=E.Class({get_Name:function(){return this.name},get_Value:function(){return this.fillWith}},de,Rt),Rt.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},Rt),nn=Tn.Event=E.Class({Trigger:function(a){var l,c,h;for(l=this.Handlers.slice(),c=0,h=l.length-1;c<=h;c++)m.get(l,c)(null,a)},Subscribe$1:function(a){var l;function c(d,p){return a.OnNext(p)}function h(){l.RemoveHandler$1(c)}return l=this,this.AddHandler$1(c),{Dispose:function(){return h()}}},AddHandler$1:function(a){this.Handlers.push(a)},RemoveHandler$1:function(a){var l,c;l=R.tryFindIndex(function(h){return _.Equals(a,h)},this.Handlers),l==null||(c=this.Handlers,c.splice.apply(c,[l.$0,1]))},Dispose:w.ignore,Subscribe:function(a){return this.Subscribe$1(a)}},null,nn),nn.New=function(a){return new nn({Handlers:a})},Ee.RenderLineChart=function(a,l,c,h){return Ee.withNewCanvas(l,function(d){var p,$,g,C,S;return p=Ee.mkInitial(a.get_DataSet(),h),$=(g={},g.datasets=[(C={type:"line"},C.label=a.get__Config().Title,C.fill=a.get__SeriesConfig().IsFilled,C.backgroundColor=w.String(a.get__SeriesConfig().FillColor),C.borderColor=w.String(a.get__SeriesConfig().StrokeColor),C.pointBackgroundColor=w.String(a.get__ColorConfig().PointColor),C.pointHoverBackgroundColor=w.String(a.get__ColorConfig().PointHighlightFill),C.pointHoverBorderColor=w.String(a.get__ColorConfig().PointHighlightStroke),C.pointBorderColor=w.String(a.get__ColorConfig().PointStrokeColor),C.data=m.map(function(D){return D[1]},p),C)],g),$.labels=m.map(function(D){return D[0]},p),S=new w.Chart(d,{data:$,options:c==null?{}:c.$0}),Ee.registerUpdater(a,function(D,q){var F;F=m.get(S.data.datasets,0).data,F[D]=q(m.get(F,D))},function(){S.update()}),Ee.onEvent(a.get_DataSet(),h,function(){var D,q,F;return D=S.data,q=D.datasets,F=D.labels,m.iter(function(I){I.data.shift()},q),F.shift(),S.update()},function(D,q){var F,I,P,b;return F=q[1],I=S.data,P=I.datasets,b=I.labels,m.iteri(function(j,k){var U;return U=k.data,U[m.length(U)]=F},P),b[m.length(b)]=q[0],S.update()})})},Ee.withNewCanvas=function(a,l){var c,h;return c=a.$0,h=a.$1,ae.Element("div",[ye.Create("width",w.String(c)),ye.Create("height",w.String(h)),se.Style("width",w.String(c)+"px"),se.Style("height",w.String(h)+"px")],[ae.Element("canvas",[se.OnAfterRender(function(d){var p;p=d.getContext("2d"),d.width=c,d.height=h,l(d,p)})],[])])},Ee.mkInitial=function(a,l){return a.$==0?yn.fold(function(c,h){var d;return d=m.length(c)-h,d>=m.length(c)?[]:d<=0?c:Ze.array(c,{$:1,$0:d},null)},m.ofSeq(a.$0),l):[]},Ee.registerUpdater=function(a,l,c){var h;function d(p,$){l(p,$),h.Update(c)}h=new dn.New(null,null),a.WebSharper_Charting_Charts_IMutableChart_2$OnUpdate(function(p){return d(p[0],p[1])})},Ee.onEvent=function(a,l,c,h){var d;a.$==1&&(d=[0],a.$0.Subscribe(Ot.observer(function(p){var $;l==null||($=l.$0,d[0]>=$&&c($,d[0])),h(d[0],p),d[0]++})))},Ee.RenderPolarAreaChart=function(a,l,c,h){return Ee.withNewCanvas(l,function(d){var p,$,g,C,S,D,q,F,I,P,b,j,k,U,O;function H(V,z){var J;J=m.get(D.data.datasets,0).data,J[V]=z(m.get(J,V)),D.update()}return p=Ee.mkInitial(a.WebSharper_Charting_Charts_IPolarAreaChart_1$get_DataSet(),null),$=m.map(function(V){return w.String(V.Color)},p),g=m.map(function(V){return w.String(V.Highlight)},p),C=m.map(function(V){return V.Value},p),S=m.map(function(V){return V.Label},p),D=new w.Chart(d,c.$==1?(q=(F={},F.datasets=[(I={type:"pie"},I.data=C,I.backgroundColor=$,I.hoverBackgroundColor=g,I)],F),q.labels=S,{data:q,options:c.$0}):c.$==2?(P=(b={},b.datasets=[(j={type:"doughnut"},j.data=C,j.backgroundColor=$,j.hoverBackgroundColor=g,j)],b),P.labels=S,{data:P,options:c.$0}):(k=(U={},U.datasets=[(O={type:"polarArea"},O.data=C,O.backgroundColor=$,O.hoverBackgroundColor=g,O)],U),k.labels=S,{data:k,options:c.$0})),Ee.onEvent(a.WebSharper_Charting_Charts_IPolarAreaChart_1$get_DataSet(),h,function(){var V,z,J;return V=D.data,z=V.datasets,J=V.labels,m.iter(function(X){X.data.shift()},z),J.shift(),D.update()},function(V,z){var J,X,ne;return J=D.data,X=J.datasets,ne=J.labels,m.iteri(function($e,oe){var ge;return ge=oe.data,ge[m.length(ge)]=z.Value},X),ne[m.length(ne)]=z.Label,D.update()}),a.WebSharper_Charting_Charts_IMutableChart_2$OnUpdate(function(V){return H(V[0],V[1])})})},Tt.defaultSize=function(){return sn.$cctor(),sn.defaultSize},rn=me.LineChart=E.Class({get_DataSet:function(){return this.dataset},get__Config:function(){return this.WebSharper_Charting_Charts_IChart_1$get_Config()},get__SeriesConfig:function(){return this.WebSharper_Charting_Charts_ISeriesChart_1$get_SeriesConfig()},get__ColorConfig:function(){return this.WebSharper_Charting_Charts_IColorChart_1$get_ColorConfig()},WebSharper_Charting_Charts_IChart_1$get_Config:function(){return this.cfg},WebSharper_Charting_Charts_ISeriesChart_1$get_SeriesConfig:function(){return this.scfg},WebSharper_Charting_Charts_IColorChart_1$get_ColorConfig:function(){return this.ccfg},WebSharper_Charting_Charts_IMutableChart_2$OnUpdate:function(a){this.event.event.Subscribe(Ot.observer(a))}},L,rn),rn.New=E.Ctor(function(a,l,c,h){L.New.call(this),this.dataset=a,this.cfg=l,this.scfg=c,this.ccfg=h,this.event=new Et.New},rn),un.streamWithLabel=function(a){function l(c,h){return[w.String(c),h]}return kt.Select(kt.Aggregate(a,[0,0],function(c,h){return function(d){var p;return p=d[0],function($){return[p+1,$]}}(c)(h)}),function(c){return l(c[0],c[1])})},me.defaultChartConfig=function(){return Re.$cctor(),Re.defaultChartConfig},me.defaultSeriesChartConfig=function(){return Re.$cctor(),Re.defaultSeriesChartConfig},me.defaultColorConfig=function(){return Re.$cctor(),Re.defaultColorConfig},me.defaultPolarData=function(){return Re.$cctor(),Re.defaultPolarData},Dn.Pie=function(a){return new fn.New({$:0,$0:R.map(function(l){return me.defaultPolarData()(l[0])(l[1])},a)},me.defaultChartConfig())},Z.CreateEmbedNode=function(){return{Current:null,Dirty:!1}},Z.UpdateEmbedNode=function(a,l){a.Current=l,a.Dirty=!0},Z.CreateRunState=function(a,l){return ir.New(De.get_Empty(),Z.CreateElemNode(a,ee.EmptyAttr(),l))},Z.PerformAnimatedUpdate=function(a,l,c){return Ae.get_UseAnimations()?G.Delay(function(){var h,d,p;return h=De.FindAll(c),d=Z.ComputeChangeAnim(l,h),p=Z.ComputeEnterAnim(l,h),G.Bind(Ae.Play(Ae.Append(d,Z.ComputeExitAnim(l,h))),function(){return G.Bind(Z.SyncElemNodesNextFrame(a,l),function(){return G.Bind(Ae.Play(p),function(){return l.PreviousNodes=h,G.Return(null)})})})}):Z.SyncElemNodesNextFrame(a,l)},Z.PerformSyncUpdate=function(a,l,c){var h;h=De.FindAll(c),Z.SyncElemNode(a,l.Top),l.PreviousNodes=h},Z.LinkElement=function(a,l){Z.InsertDoc(a,l,null)},Z.InsertBeforeDelim=function(a,l){var c,h;return c=a.parentNode,h=self.document.createTextNode(""),c.insertBefore(h,a),Z.LinkPrevElement(a,l),h},Z.CreateElemNode=function(a,l,c){var h;return Z.LinkElement(a,c),h=ee.Insert(a,l),Ct.New(h,c,null,a,ze.Int(),E.GetOptional(h.OnAfterRender))},Z.SyncElemNodesNextFrame=function(a,l){function c(h){w.requestAnimationFrame(function(){Z.SyncElemNode(a,l.Top),h()})}return Mn.BatchUpdatesEnabled()?G.FromContinuations(function(h,d,p){return c.apply(null,[h,d,p])}):(Z.SyncElemNode(a,l.Top),G.Return(null))},Z.ComputeExitAnim=function(a,l){return Ae.Concat(m.map(function(c){return ee.GetExitAnim(c.Attr)},De.ToArray(De.Except(l,De.Filter(function(c){return ee.HasExitAnim(c.Attr)},a.PreviousNodes)))))},Z.ComputeEnterAnim=function(a,l){return Ae.Concat(m.map(function(c){return ee.GetEnterAnim(c.Attr)},De.ToArray(De.Except(a.PreviousNodes,De.Filter(function(c){return ee.HasEnterAnim(c.Attr)},l)))))},Z.ComputeChangeAnim=function(a,l){var c;function h(d){return ee.HasChangeAnim(d.Attr)}return c=function(d){return De.Filter(h,d)},Ae.Concat(m.map(function(d){return ee.GetChangeAnim(d.Attr)},De.ToArray(De.Intersect(c(a.PreviousNodes),c(l)))))},Z.SyncElemNode=function(a,l){a||Z.SyncElement(l),Z.Sync(l.Children),Z.AfterRender(l)},Z.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:!1,Value:""}},Z.UpdateTextNode=function(a,l){a.Value=l,a.Dirty=!0},Z.InsertDoc=function(a,l,c){for(var h,d,p;;){if(l!=null&&l.$==1)return Z.InsertNode(a,l.$0.El,c);if(l!=null&&l.$==2)h=l.$0,h.Dirty=!1,l=h.Current;else{if(l==null)return c;if(l!=null&&l.$==4)return Z.InsertNode(a,l.$0.Text,c);if(l!=null&&l.$==5)return Z.InsertNode(a,l.$0,c);if(l!=null&&l.$==6)return m.foldBack(function($,g){return E.Curried3(function(C,S,D){return S==null||S.constructor===tn?Z.InsertDoc(C,S,D):Z.InsertNode(C,S,D)})(a)($)(g)},l.$0.Els,c);d=l.$1,p=l.$0,l=p,c=Z.InsertDoc(a,d,c)}}},Z.LinkPrevElement=function(a,l){Z.InsertDoc(a.parentNode,l,a)},Z.SyncElement=function(a){function l(c){function h(d){for(var p,$,g,C;;)if(d!=null&&d.$==0){if($=d.$1,g=d.$0,h(g))return!0;d=$}else if(d!=null&&d.$==2){if(C=d.$0,C.Dirty)return!0;d=C.Current}else return d!=null&&d.$==6&&(p=d.$0,p.Dirty||m.exists(l,p.Holes))}return h(c.Children)}ee.Sync(a.El,a.Attr),l(a)&&Z.DoSyncElement(a)},Z.Sync=function(a){for(var l,c,h,d,p;;){if(a!=null&&a.$==1)return Z.SyncElemNode(!1,a.$0);if(a!=null&&a.$==2)h=a.$0,a=h.Current;else{if(a==null)return null;if(a!=null&&a.$==5)return null;if(a!=null&&a.$==4)return l=a.$0,l.Dirty?(l.Text.nodeValue=l.Value,l.Dirty=!1):null;if(a!=null&&a.$==6)return c=a.$0,m.iter(function($){Z.SyncElemNode(!1,$)},c.Holes),m.iter(function($){ee.Sync($[0],$[1])},c.Attrs),Z.AfterRender(c);d=a.$1,p=a.$0,Z.Sync(p),a=d}}},Z.AfterRender=function(a){var l;l=E.GetOptional(a.Render),l!=null&&l.$==1&&(l.$0(a.El),E.SetOptional(a,"Render",null))},Z.InsertNode=function(a,l,c){return we.InsertAt(a,c,l),l},Z.DoSyncElement=function(a){var l,c,h;function d(p,$){for(var g,C,S,D;;){if(p!=null&&p.$==1)return p.$0.El;if(p!=null&&p.$==2){if(C=p.$0,C.Dirty)return C.Dirty=!1,Z.InsertDoc(l,C.Current,$);p=C.Current}else{if(p==null)return $;if(p!=null&&p.$==4)return p.$0.Text;if(p!=null&&p.$==5)return p.$0;if(p!=null&&p.$==6)return g=p.$0,g.Dirty&&(g.Dirty=!1),m.foldBack(function(q,F){return q==null||q.constructor===tn?d(q,F):q},g.Els,$);S=p.$1,D=p.$0,p=D,$=d(S,$)}}}l=a.El,yt.Iter((c=a.El,function(p){we.RemoveNode(c,p)}),yt.Except(yt.DocChildren(a),yt.Children(a.El,E.GetOptional(a.Delimiters)))),d(a.Children,(h=E.GetOptional(a.Delimiters),h!=null&&h.$==1?h.$0[1]:null))},on=G.Scheduler=E.Class({Fork:function(a){var l;l=this,this.robin.push(a),this.idle&&(this.idle=!1,w.setTimeout(function(){l.tick()},0))},tick:function(){var a,l,c;for(l=this,c=Kt.now(),a=!0;a;)this.robin.length===0?(this.idle=!0,a=!1):(this.robin.shift()(),Kt.now()-c>40&&(w.setTimeout(function(){l.tick()},0),a=!1))}},L,on),on.New=E.Ctor(function(){L.New.call(this),this.idle=!0,this.robin=[]},on),be=Y.T=E.Class({MoveNext:function(){var a;return a=this.n(this),this.e=a?1:2,a},Current:function(){return this.e===1?this.c:this.e===0?he.FailWith("Enumeration has not started. Call MoveNext."):he.FailWith("Enumeration already finished.")},Dispose:function(){this.d&&this.d(this)}},L,be),be.New=E.Ctor(function(a,l,c,h){L.New.call(this),this.s=a,this.c=l,this.n=c,this.d=h,this.e=0},be),Le=pe.FSharpMap=E.Class({GetEnumerator:function(){return Y.Get(R.map(function(a){return{K:a.Key,V:a.Value}},ce.Enumerate(!1,this.tree)))},Equals:function(a){return this.Count()===a.Count()&&R.forall2(_.Equals,this,a)},Count:function(){var a;return a=this.tree,a==null?0:a.Count},Add$1:function(a,l){return new Le.New$1(ce.Add(_t.New(a,l),this.tree))},get_IsEmpty:function(){return this.tree==null},GetHashCode:function(){return _.Hash(m.ofSeq(this))},get_Tree:function(){return this.tree},CompareTo0:function(a){return R.compareWith(_.Compare,this,a)}},L,Le),Le.New=E.Ctor(function(a){Le.New$1.call(this,tr.fromSeq(a))},Le),Le.New$1=E.Ctor(function(a){L.New.call(this),this.tree=a},Le),Dt.OfArray=function(a){return new Le.New$1(ce.OfSeq(R.map(function(l){return _t.New(l[0],l[1])},a)))},Dt.FoldBack=function(a,l,c){return R.fold(function(h,d){return a(d.Key,d.Value,h)},c,ce.Enumerate(!0,l.get_Tree()))},Dt.ToSeq=function(a){return R.map(function(l){return[l.Key,l.Value]},ce.Enumerate(!1,a.get_Tree()))},re.StartsWith=function(a,l){return a.substring(0,l.length)==l},re.Substring=function(a,l,c){return a.substr(l,c)},re.SplitChars=function(a,l,c){return re.Split(a,new w.RegExp("["+re.RegexEscape(l.join(""))+"]"),c)},re.Split=function(a,l,c){return c===1?m.filter(function(h){return h!==""},re.SplitWith(a,l)):re.SplitWith(a,l)},re.RegexEscape=function(a){return a.replace(new w.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&")},re.SplitWith=function(a,l){return a.split(l)},re.concat=function(a,l){return m.ofSeq(l).join(a)},re.IsNullOrEmpty=function(a){return a==null||a==""},re.Join=function(a,l){return l.join(a)},re.forall=function(a,l){return R.forall(a,re.protect(l))},re.protect=function(a){return a??""},kn.toSafe=function(a){return a??""},Ce=pe.HashSet=E.Class({SAdd:function(a){return this.add(a)},Contains:function(a){var l;return l=this.data[this.hash(a)],l==null?!1:this.arrContains(a,l)},add:function(a){var l,c;return l=this.hash(a),c=this.data[l],c==null?(this.data[l]=[a],this.count=this.count+1,!0):this.arrContains(a,c)?!1:(c.push(a),this.count=this.count+1,!0)},arrContains:function(a,l){var c,h,d;for(c=!0,h=0,d=l.length;c&&h<d;)this.equals.apply(null,[l[h],a])?c=!1:h=h+1;return!c},GetEnumerator:function(){return Y.Get(Sn.concat(this.data))},ExceptWith:function(a){var l;l=Y.Get(a);try{for(;l.MoveNext();)this.Remove(l.Current())}finally{typeof l=="object"&&"Dispose"in l&&l.Dispose()}},Count:function(){return this.count},IntersectWith:function(a){var l,c,h,d,p;for(l=new Ce.New$4(a,this.equals,this.hash),c=Sn.concat(this.data),h=0,d=c.length-1;h<=d;h++)p=c[h],l.Contains(p)||this.Remove(p)},Remove:function(a){var l;return l=this.data[this.hash(a)],l==null?!1:this.arrRemove(a,l)&&(this.count=this.count-1,!0)},CopyTo:function(a,l){var c,h,d;for(c=Sn.concat(this.data),h=0,d=c.length-1;h<=d;h++)m.set(a,h+l,c[h])},arrRemove:function(a,l){var c,h,d;for(c=!0,h=0,d=l.length;c&&h<d;)this.equals.apply(null,[l[h],a])?(l.splice.apply(l,[h,1]),c=!1):h=h+1;return!c}},L,Ce),Ce.New$3=E.Ctor(function(){Ce.New$4.call(this,[],_.Equals,_.Hash)},Ce),Ce.New$4=E.Ctor(function(a,l,c){var h;L.New.call(this),this.equals=l,this.hash=c,this.data=[],this.count=0,h=Y.Get(a);try{for(;h.MoveNext();)this.add(h.Current())}finally{typeof h=="object"&&"Dispose"in h&&h.Dispose()}},Ce),Ce.New$2=E.Ctor(function(a){Ce.New$4.call(this,a,_.Equals,_.Hash)},Ce),Te.$cctor=function(){Te.$cctor=w.ignore,Te.initialized=new Ne.New$5},Te=Ge.TemplateInitializer=E.Class({},L,Te),Te.GetOrAddHoleFor=function(a,l,c){var h,d,p,$;return Te.$cctor(),h=Te.GetHolesFor(a),d=(p=null,[h.TryGetValue(l,{get:function(){return p},set:function(g){p=g}}),p]),d[0]?d[1]:($=c(),h.set_Item(l,$),$)},Te.GetHolesFor=function(a){var l,c,h;return Te.$cctor(),l=(c=null,[Te.initialized.TryGetValue(a,{get:function(){return c},set:function(d){c=d}}),c]),l[0]?l[1]:(h=new Ne.New$5,Te.initialized.set_Item(a,h),h)},an=ue.VarBool=E.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:W.Map(w.String,this.fillWith.get_View())}},AddAttribute:function(a,l){a(l)(se.Checked(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:W.Map(w.String,this.fillWith.get_View())}}},de,an),an.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},an),ln=ue.VarDateTime=E.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:W.Map(function(a){return new Kt(a).toLocaleString()},this.fillWith.get_View())}},AddAttribute:function(a,l){a(l)(se.DateTimeValue(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:W.Map(function(a){return new Kt(a).toLocaleString()},this.fillWith.get_View())}}},de,ln),ln.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},ln),cn=ue.VarFile=E.Class({get_Name:function(){return this.name},ForTextView:function(){return{$:1,$0:W.Map(w.String,this.fillWith.get_View())}},AddAttribute:function(a,l){a(l)(se.FileValue(this.fillWith))},get_AsChoiceView:function(){return{$:1,$0:W.Map(w.String,this.fillWith.get_View())}}},de,cn),cn.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},cn),Ut=ue.VarDomElement=E.Class({get_Name:function(){return this.name},get_Value:function(){return this.fillWith}},de,Ut),Ut.New=E.Ctor(function(a,l){de.New.call(this),this.name=a,this.fillWith=l},Ut),B.RunFullDocTemplate=function(a){var l,c,h;return B.RenderedFullDocTemplate()==null?(l=(B.LoadLocalTemplates(""),B.PrepareTemplateStrict("",null,self.document.body,null),c=B.ChildrenTemplate(self.document.body,a),h=self.document.body,function(d){ae.RunInPlace(!0,h,d)}(c),c),B.set_RenderedFullDocTemplate({$:1,$0:l}),l):B.RenderedFullDocTemplate().$0},B.LoadLocalTemplates=function(a){B.LocalTemplatesLoaded()||(B.set_LocalTemplatesLoaded(!0),B.LoadNestedTemplates(self.document.body,"")),B.LoadedTemplates().set_Item(a,B.LoadedTemplateFile(""))},B.NamedTemplate=function(a,l,c){var h,d;return h=(d=null,[B.LoadedTemplateFile(a).TryGetValue(l==null?"":l.$0,{get:function(){return d},set:function(p){d=p}}),d]),h[0]?B.ChildrenTemplate(h[1].cloneNode(!0),c):(ke.warn("Local template doesn't exist",l),ae.get_Empty())},B.RenderedFullDocTemplate=function(){return ve.$cctor(),ve.RenderedFullDocTemplate},B.PrepareTemplateStrict=function(a,l,c,h){var d,p;function $(F,I){var P,b,j,k,U,O,H,V,z,J,X,ne,$e,oe,ge,Ue,xe,Ye,je,Mt,Ie,Ke,et,st,ot;function Gt(We){}for(;;)switch(F){case 0:if(I!==null)P=I.nextSibling,_.Equals(I.nodeType,mt.TEXT_NODE)?Se.convertTextNode(I):_.Equals(I.nodeType,mt.ELEMENT_NODE)&&C(I),I=P;else return null;break;case 1:if(U=Ze.string(I.nodeName,{$:1,$0:3},null).toLowerCase(),O=(b=U.indexOf("."),b===-1?[a,U]:[Ze.string(U,null,{$:1,$0:b-1}),Ze.string(U,{$:1,$0:b+1},null)]),H=O[1],V=O[0],V!=""&&!B.LoadedTemplates().ContainsKey(V))return Se.failNotLoaded(H);if(V==""&&h!=null&&h.$0(H),z=B.LoadedTemplates().Item(V),z.ContainsKey(H)){for(J=z.Item(H),X=J.cloneNode(!0),ne=new Ce.New$3,$e=new Ne.New$5,oe=I.attributes,ge=0,Ue=oe.length-1;ge<=Ue;ge++)xe=oe.item(ge).name.toLowerCase(),$e.set_Item(xe,(Ye=oe.item(ge).nodeValue,Ye==""?xe:Ye.toLowerCase())),ne.SAdd(xe)||ke.warn("Hole mapped twice",xe);for(je=0,Mt=I.childNodes.length-1;je<=Mt;je++)Ie=I.childNodes[je],_.Equals(Ie.nodeType,mt.ELEMENT_NODE)&&(ne.SAdd(Ie.nodeName.toLowerCase())||ke.warn("Hole filled twice",H));if(Ke=I.childNodes.length===1&&_.Equals(I.firstChild.nodeType,mt.TEXT_NODE),Ke&&(j=Se.fillTextHole(X,I.firstChild.textContent,H),function(We){return function(tt){tt!=null&&We(tt.$0)}}((k=function(We){return function(tt){return We.SAdd(tt)}}(ne),function(We){return k(We),void 0}))(j)),Se.removeHolesExcept(X,ne),!Ke)for(et=0,st=I.childNodes.length-1;et<=st;et++)ot=I.childNodes[et],_.Equals(ot.nodeType,mt.ELEMENT_NODE)&&(ot.hasAttributes()?Se.fillInstanceAttrs(X,ot):g(X,ot));Se.mapHoles(X,$e),Se.fill(X,I.parentNode,I),I.parentNode.removeChild(I);return}else return Se.failNotLoaded(H)}}function g(F,I){var P,b,j,k;function U(O,H){var V;if(j=="title"&&I.hasChildNodes())for(V=we.ParseHTMLIntoFakeRoot(I.textContent),I.removeChild(I.firstChild);V.hasChildNodes();)I.appendChild(V.firstChild);return C(I),Se.fill(I,O,H)}if(j=I.nodeName.toLowerCase(),B.foreachNotPreserved(F,"[ws-attr-holes]",function(O){var H,V,z,J,X;for(H=re.SplitChars(O.getAttribute("ws-attr-holes"),[" "],1),V=0,z=H.length-1;V<=z;V++)J=m.get(H,V),O.setAttribute(J,(X=new w.RegExp("\\${"+j+"}","ig"),O.getAttribute(J).replace(X,I.textContent)))}),k=F.querySelector("[ws-hole="+j+"]"),_.Equals(k,null))return P=F.querySelector("[ws-replace="+j+"]"),_.Equals(P,null)?(b=F.querySelector("slot[name="+j+"]"),F.tagName.toLowerCase()=="template"?(U(b.parentNode,b),void b.parentNode.removeChild(b)):null):(U(P.parentNode,P),void P.parentNode.removeChild(P));for(;k.hasChildNodes();)k.removeChild(k.lastChild);return k.removeAttribute("ws-hole"),U(k,null)}function C(F){F.hasAttribute("ws-preserve")||(re.StartsWith(F.nodeName.toLowerCase(),"ws-")?D(F):(Se.convertAttrs(F),S(F.firstChild)))}function S(F){return $(0,F)}function D(F){return $(1,F)}function q(F){for(var I,P,b,j,k,U,O,H,V,z,J,X;;)if(I=F.querySelector("[ws-template]"),_.Equals(I,null))if(P=F.querySelector("[ws-children-template]"),_.Equals(P,null)){for(b=F.querySelectorAll("template[id]"),j=1,k=b.length-1;j<=k;j++)U=b[j],d.Contains(U)||(B.PrepareTemplateStrict(a,{$:1,$0:U.getAttribute("id")},U,null),d.SAdd(U));for(O=F.querySelectorAll("template[name]"),H=1,V=O.length-1;H<=V;H++)z=O[H],d.Contains(z)||(B.PrepareTemplateStrict(a,{$:1,$0:z.getAttribute("name")},z,null),d.SAdd(z));return null}else J=P.getAttribute("ws-children-template"),P.removeAttribute("ws-children-template"),B.PrepareTemplateStrict(a,{$:1,$0:J},P,null),F=F;else X=I.getAttribute("ws-template"),B.PrepareSingleTemplate(a,{$:1,$0:X},I)(null),F=F}d=new Ce.New$3,p=(l==null?"":l.$0).toLowerCase(),B.LoadedTemplateFile(a).set_Item(p,c),c.hasChildNodes()&&(q(c),S(c.firstChild))},B.ChildrenTemplate=function(a,l){var c,h,d,p;return c=B.InlineTemplate(a,R.append(l,B.GlobalHoles().Values())),h=c[1],d=c[0],p=d.Els,!_.Equals(p,null)&&p.length===1&&m.get(p,0)instanceof mt&&_.Equals(m.get(p,0).nodeType,mt.ELEMENT_NODE)&&(m.get(p,0),!0)?it.TreeNode(d,h):ae.Mk({$:6,$0:d},h)},B.set_RenderedFullDocTemplate=function(a){ve.$cctor(),ve.RenderedFullDocTemplate=a},B.LocalTemplatesLoaded=function(){return ve.$cctor(),ve.LocalTemplatesLoaded},B.set_LocalTemplatesLoaded=function(a){ve.$cctor(),ve.LocalTemplatesLoaded=a},B.LoadNestedTemplates=function(a,l){var c,h,d,p,$,g,C,S,D,q,F,I,P,b,j,k,U,O,H,V,z;function J(X){var ne,$e;c.ContainsKey(X)||(ne=($e=null,[h.TryGetValue(X,{get:function(){return $e},set:function(oe){$e=oe}}),$e]),ne[0]?(z.SAdd(X),h.RemoveKey(X),B.PrepareTemplateStrict(l,{$:1,$0:X},ne[1],{$:1,$0:J})):ke.warn(z.Contains(X)?"Encountered loop when instantiating "+X:"Local template does not exist: "+X))}for(c=B.LoadedTemplateFile(l),h=new Ne.New$5,d=a.querySelectorAll("[ws-template]"),p=0,$=d.length-1;p<=$;p++)g=d[p],C=g.getAttribute("ws-template").toLowerCase(),g.removeAttribute("ws-template"),h.set_Item(C,B.FakeRootSingle(g));for(S=a.querySelectorAll("[ws-children-template]"),D=0,q=S.length-1;D<=q;D++)F=S[D],I=F.getAttribute("ws-children-template").toLowerCase(),F.removeAttribute("ws-children-template"),h.set_Item(I,B.FakeRoot(F));for(P=a.querySelectorAll("template[id]"),b=0,j=P.length-1;b<=j;b++)k=P[b],h.set_Item(k.getAttribute("id").toLowerCase(),B.FakeRootFromHTMLTemplate(k));for(U=a.querySelectorAll("template[name]"),O=0,H=U.length-1;O<=H;O++)V=U[O],h.set_Item(V.getAttribute("name").toLowerCase(),B.FakeRootFromHTMLTemplate(V));for(z=new Ce.New$3;h.count>0;)J(R.head(h.Keys()))},B.LoadedTemplates=function(){return ve.$cctor(),ve.LoadedTemplates},B.LoadedTemplateFile=function(a){var l,c,h;return l=(c=null,[B.LoadedTemplates().TryGetValue(a,{get:function(){return c},set:function(d){c=d}}),c]),l[0]?l[1]:(h=new Ne.New$5,B.LoadedTemplates().set_Item(a,h),h)},B.foreachNotPreserved=function(a,l,c){we.IterSelector(a,l,function(h){h.closest("[ws-preserve]")==null&&c(h)})},B.PrepareSingleTemplate=function(a,l,c){var h;return h=B.FakeRootSingle(c),function(d){B.PrepareTemplateStrict(a,l,h,d)}},B.InlineTemplate=function(a,l){var c,h,d,p,$,g,C,S,D,q,F,I;function P(k,U){var O,H,V;return O=ee.Insert(k,U),C.push(ee.Updates(O)),S.push([k,O]),H=E.GetOptional(O.OnAfterRender),H==null?null:(V=H.$0,void D.push(function(){V(k)}))}function b(k){var U,O,H,V;return U=(O=null,[q.TryGetValue(k,{get:function(){return O},set:function(z){O=z}}),O]),U[0]?(H=U[1],H instanceof Je?{$:1,$0:H.get_Value()}:H instanceof _e?{$:1,$0:ae.TextNode(H.get_Value())}:(V=H.ForTextView(),V==null?null:{$:1,$0:ae.TextView(V.$0)})):null}function j(){B.foreachNotPreservedwsDOM("[ws-dom]",function(k){var U,O,H,V,z,J,X;U=(O=null,[q.TryGetValue(k.getAttribute("ws-dom").toLowerCase(),{get:function(){return O},set:function(ne){O=ne}}),O]),U[0]&&(H=U[1],H instanceof Ut&&(V=H.get_Value(),k.removeAttribute("ws-dom"),z=k,J=new w.MutationObserver(function(ne,$e){m.iter(function(oe){function ge(Ue,xe,Ye,je){Ue===z&&oe.addedNodes.length!==1&&(V.SetFinal(null),$e.disconnect())}oe.removedNodes.forEach(E.CreateFuncWithArgs(function(Ue){return ge(Ue[0],Ue[1],Ue[2],Ue[3])}),null)},ne)}),k.parentElement!==null&&J.observe(k.parentElement,(X={},X.childList=!0,X)),V.Set({$:1,$0:k}),W.Sink(function(ne){var $e;ne!=null&&ne.$==1?($e=ne.$0,z===$e||(z.replaceWith.apply(z,[$e]),z=$e)):(z.remove(),J.disconnect())},V.get_View())))})}g=[],C=[],S=[],D=[],q=new Ne.New$5,F=Y.Get(l);try{for(;F.MoveNext();)I=F.Current(),q.set_Item(I.get_Name(),I)}finally{typeof F=="object"&&"Dispose"in F&&F.Dispose()}return c=we.ChildrenArray(a),B.foreachNotPreserved(a,"[ws-hole]",function(k){var U,O,H;for(H=k.getAttribute("ws-hole"),k.removeAttribute("ws-hole");k.hasChildNodes();)k.removeChild(k.lastChild);U=b(H),U!=null&&U.$==1&&(O=U.$0,Z.LinkElement(k,O.docNode),g.push(Ct.New(ee.Empty(k),O.docNode,null,k,ze.Int(),null)),C.push(O.updates))}),B.foreachNotPreserved(a,"[ws-replace]",function(k){var U,O,H,V,z,J;U=b(k.getAttribute("ws-replace")),U!=null&&U.$==1&&(O=U.$0,H=k.parentNode,V=self.document.createTextNode(""),H.replaceChild(V,k),z=Z.InsertBeforeDelim(V,O.docNode),J=m.tryFindIndex(function(X){return k===X},c),J==null||m.set(c,J.$0,O.docNode),g.push(Ct.New(ee.Empty(H),O.docNode,{$:1,$0:[z,V]},H,ze.Int(),null)),C.push(O.updates))}),h=!1,B.foreachNotPreserved(a,"slot",function(k){var U,O,H,V;if(H=k.getAttribute("name"),V=H==""||H==null?"default":H.toLowerCase(),!(h&&V=="default"||!_.Equals(a.parentElement,null))){for(;k.hasChildNodes();)k.removeChild(k.lastChild);V=="default"&&(h=!0),U=b(V),U!=null&&U.$==1&&(O=U.$0,Z.LinkElement(k,O.docNode),g.push(Ct.New(ee.Empty(k),O.docNode,null,k,ze.Int(),null)),C.push(O.updates))}}),B.foreachNotPreserved(a,"[ws-attr]",function(k){var U,O,H,V;U=k.getAttribute("ws-attr"),k.removeAttribute("ws-attr"),O=(H=null,[q.TryGetValue(U,{get:function(){return H},set:function(z){H=z}}),H]),O[0]&&(V=O[1],V instanceof In?P(k,V.get_Value()):ke.warn("Attribute hole filled with non-attribute data",U))}),B.foreachNotPreserved(a,"[ws-on]",function(k){P(k,ye.Concat(m.choose(function(U){var O,H,V,z;return O=re.SplitChars(U,[":"],1),H=(V=null,[q.TryGetValue(m.get(O,1),{get:function(){return V},set:function(J){V=J}}),V]),H[0]?(z=H[1],z instanceof bn?{$:1,$0:se.Handler(m.get(O,0),z.get_Value())}:z instanceof Rt?{$:1,$0:ye.Handler(m.get(O,0),z.get_Value())}:(ke.warn("Event hole on"+m.get(O,0)+" filled with non-event data",m.get(O,1)),null)):null},re.SplitChars(k.getAttribute("ws-on"),[" "],1)))),k.removeAttribute("ws-on")}),B.foreachNotPreserved(a,"[ws-onafterrender]",function(k){var U,O,H,V;U=k.getAttribute("ws-onafterrender"),O=(H=null,[q.TryGetValue(U,{get:function(){return H},set:function(z){H=z}}),H]),O[0]&&(V=O[1],V instanceof Vn||V instanceof Ln?(k.removeAttribute("ws-onafterrender"),P(k,se.OnAfterRender(V.get_Value()))):ke.warn("onafterrender hole filled with non-onafterrender data",U))}),B.foreachNotPreserved(a,"[ws-var]",function(k){var U,O,H;U=k.getAttribute("ws-var"),k.removeAttribute("ws-var"),O=(H=null,[q.TryGetValue(U,{get:function(){return H},set:function(V){H=V}}),H]),O[0]&&O[1].AddAttribute(function(V){return function(z){return P(V,z)}},k)}),B.foreachNotPreserved(a,"[ws-attr-holes]",function(k){var U,O,H,V;for(U=new w.RegExp(B.TextHoleRE(),"g"),O=re.SplitChars(k.getAttribute("ws-attr-holes"),[" "],1),k.removeAttribute("ws-attr-holes"),H=0,V=O.length-1;H<=V;H++)(function(){var z,J,X,ne,$e,oe,ge,Ue,xe,Ye,je,Mt;for(xe=m.get(O,H),Ye=k.getAttribute(xe),z=null,J=0,je=[];z=U.exec(Ye),z!==null;)Mt=Ze.string(Ye,{$:1,$0:J},{$:1,$0:U.lastIndex-m.get(z,0).length-1}),J=U.lastIndex,je.push([Mt,m.get(z,1)]);return X=Ze.string(Ye,{$:1,$0:J},null),U.lastIndex=0,ne=m.foldBack(function(Ie,Ke){return function(et){var st,ot;return st=et[0],ot=et[1],function(Gt){var We,tt,Nt,Jt,Pt;return We=Gt[0],tt=Gt[1],Nt=(Jt=(Pt=null,[q.TryGetValue(ot,{get:function(){return Pt},set:function(ft){Pt=ft}}),Pt]),Jt[0]?Jt[1].get_AsChoiceView():{$:0,$0:""}),Nt.$==1?[st,new le({$:1,$0:We==""?Nt.$0:W.Map(function(ft){return ft+We},Nt.$0),$1:tt})]:[st+Nt.$0+We,tt]}}(Ie)(Ke)},je,[X,le.Empty]),P(k,ne[1].$==1?ne[1].$1.$==1?ne[1].$1.$1.$==1?ne[1].$1.$1.$1.$==0?($e=ne[0],se.Dynamic(xe,W.Map3(function(Ie,Ke,et){return $e+Ie+Ke+et},ne[1].$0,ne[1].$1.$0,ne[1].$1.$1.$0))):(oe=ne[0],se.Dynamic(xe,W.Map(function(Ie){return oe+re.concat("",Ie)},W.Sequence(ne[1])))):(ge=ne[0],se.Dynamic(xe,W.Map2(function(Ie,Ke){return ge+Ie+Ke},ne[1].$0,ne[1].$1.$0))):ne[0]==""?se.Dynamic(xe,ne[1].$0):(Ue=ne[0],se.Dynamic(xe,W.Map(function(Ie){return Ue+Ie},ne[1].$0))):ye.Create(xe,ne[0]))})()}),[E.DeleteEmptyFields({Els:c,Dirty:!0,Holes:g,Attrs:S,Render:(d=D.length==0?{$:1,$0:function(){j()}}:{$:1,$0:function(k){j(),m.iter(function(U){U(k)},D)}},d?d.$0:void 0),El:(p=!_.Equals(c,null)&&c.length===1&&m.get(c,0)instanceof mt&&m.get(c,0)instanceof hr&&($=m.get(c,0),!0)?{$:1,$0:$}:null,p?p.$0:void 0)},["Render","El"]),Pe.TreeReduce(W.Const(),W.Map2Unit,C)]},B.GlobalHoles=function(){return ve.$cctor(),ve.GlobalHoles},B.FakeRootSingle=function(a){var l,c,h,d;return a.removeAttribute("ws-template"),l=a.getAttribute("ws-replace"),l==null||(a.removeAttribute("ws-replace"),c=a.parentNode,_.Equals(c,null)||(h=self.document.createElement(a.tagName),h.setAttribute("ws-replace",l),c.replaceChild(h,a))),d=self.document.createElement("div"),d.appendChild(a),d},B.FakeRoot=function(a){var l;for(l=self.document.createElement("div");a.hasChildNodes();)l.appendChild(a.firstChild);return l},B.FakeRootFromHTMLTemplate=function(a){var l,c,h,d;for(l=self.document.createElement("div"),c=a.content,h=0,d=c.childNodes.length-1;h<=d;h++)l.appendChild(c.childNodes[h].cloneNode(!0));return l},B.TextHoleRE=function(){return ve.$cctor(),ve.TextHoleRE},B.foreachNotPreservedwsDOM=function(a,l){we.IterSelectorDoc(a,function(c){c.closest("[ws-preserve]")==null&&l(c)})},xn.New=function(a,l){return{k:a,ct:l}},Ve.$cctor=function(){Ve.$cctor=w.ignore,Ve.noneCT=Gn.New(!1,[]),Ve.scheduler=new on.New,Ve.defCTS=[new hn.New],Ve.Zero=G.Return(),Ve.GetCT=function(a){a.k({$:0,$0:a.ct})}},Gn.New=function(a,l){return{c:a,r:l}},Jn.New=function(a){return{Title:a}},zn.New=function(a,l,c,h,d){return{XAxis:a,YAxis:l,FillColor:c,StrokeColor:h,IsFilled:d}},Qn.New=function(a,l,c,h){return{PointColor:a,PointHighlightFill:l,PointHighlightStroke:c,PointStrokeColor:h}},sn.$cctor=function(){sn.$cctor=w.ignore,sn.defaultSize={$:0,$0:500,$1:200}},kt.Select=function(a,l){return kt.New(function(c){return a.Subscribe(Ot.observer(function(h){c.OnNext(l(h))}))})},kt.Aggregate=function(a,l,c){return kt.New(function(h){var d;return d=[l],a.Subscribe(Ot.observer(function(p){d[0]=c(d[0],p),h.OnNext(d[0])}))})},kt.New=function(a){return{Subscribe:a}},Re.$cctor=function(){var a;Re.$cctor=w.ignore,Re.defaultChartConfig=Jn.New("Chart"),Re.defaultSeriesChartConfig=zn.New("x","y",new rt({$:0,$0:220,$1:220,$2:220,$3:.2}),new rt({$:0,$0:220,$1:220,$2:220,$3:1}),!0),Re.defaultColorConfig=Qn.New(new rt({$:0,$0:220,$1:220,$2:220,$3:1}),new rt({$:1,$0:"#fff"}),new rt({$:0,$0:220,$1:220,$2:220,$3:1}),new rt({$:1,$0:"#fff"})),Re.defaultPolarData=(a=new Vt.New,function(l){return function(c){var h,d,p,$;return h=(d=a.Next(0,256),p=a.Next(0,256),$=a.Next(0,256),[new rt({$:0,$0:d,$1:p,$2:$,$3:1}),new rt({$:0,$0:d,$1:p,$2:$,$3:.6})]),er.New(c,h[0],h[1],l)}})},fn=me.PieChart=E.Class({WebSharper_Charting_Charts_IChart_1$get_Config:function(){return this.cfg},WebSharper_Charting_Charts_IMutableChart_2$OnUpdate:function(a){this.event.event.Subscribe(Ot.observer(a))},WebSharper_Charting_Charts_IPolarAreaChart_1$get_DataSet:function(){return this.dataset}},L,fn),fn.New=E.Ctor(function(a,l){L.New.call(this),this.dataset=a,this.cfg=l,this.event=new Et.New},fn),xt.$cctor=function(){xt.$cctor=w.ignore,xt.counter=0},Zn.New=function(a,l,c,h,d){return{Node:a,Left:l,Right:c,Height:h,Count:d}},_t=pe.Pair=E.Class({Equals:function(a){return _.Equals(this.Key,a.Key)},GetHashCode:function(){return _.Hash(this.Key)},CompareTo0:function(a){return _.Compare(this.Key,a.Key)}},null,_t),_t.New=function(a,l){return new _t({Key:a,Value:l})},Xn.notPresent=function(){throw new ct.New},lt=N.OperationCanceledException=E.Class({},_n,lt),lt.New=E.Ctor(function(a){lt.New$1.call(this,"The operation was canceled.",null,a)},lt),lt.New$1=E.Ctor(function(a,l,c){this.message=a,this.inner=l,tn.setPrototypeOf(this,lt.prototype),this.ct=c},lt),hn=N.CancellationTokenSource=E.Class({},L,hn),hn.New=E.Ctor(function(){L.New.call(this),this.c=!1,this.pending=null,this.r=[],this.init=1},hn),Yn=Fn.attr=E.Class({},L,Yn),se.Style=function(a,l){return ee.Static(function(c){c.style.setProperty(a,l)})},se.OnAfterRender=function(a){return new ye({$:4,$0:a})},se.Handler=function(a,l){return ee.Static(function(c){c.addEventListener(a,function(h){return l(c)(h)},!1)})},se.Dynamic=function(a,l){return ee.Dynamic(l,function(c){return function(h){return c.setAttribute(a,h)}})},se.FloatValueUnchecked=function(a){return se.ValueWith(te.FloatApplyUnchecked(),a)},se.Value=function(a){return se.ValueWith(te.StringApply(),a)},se.Checked=function(a){return se.ValueWith(te.BoolCheckedApply(),a)},se.DateTimeValue=function(a){return se.ValueWith(te.DateTimeApplyUnchecked(),a)},se.FileValue=function(a){return se.ValueWith(te.FileApplyUnchecked(),a)},se.ValueWith=function(a,l){var c;return c=a(l),ye.Append(ee.Static(c[0]),se.DynamicCustom(c[1],c[2]))},se.DynamicCustom=function(a,l){return ee.Dynamic(l,a)},Ze.array=function(a,l,c){var h,d;return l==null?c!=null&&c.$==1?(h=c.$0,h<0?[]:a.slice(0,h+1)):[]:c==null?a.slice(l.$0):(d=c.$0,d<0?[]:a.slice(l.$0,d+1))},Ze.string=function(a,l,c){var h,d;return l==null?c!=null&&c.$==1?(h=c.$0,h<0?"":a.slice(0,h+1)):"":c==null?a.slice(l.$0):(d=c.$0,d<0?"":a.slice(l.$0,d+1))},rt=un.Color=E.Class({toString:function(){return this.$==1?this.$0:this.$==2?this.$0:"rgba("+w.String(this.$0)+", "+w.String(this.$1)+", "+w.String(this.$2)+", "+this.$3.toFixed(6)+")"}},null,rt),dn=Ee.BatchUpdater=E.Class({Update:function(a){var l,c;function h(){l.handle[0]=null,l.count[0]=0,a()}l=this,c=this.handle[0],c==null||w.clearTimeout(c.$0),this.count[0]<this.maxCount?(this.count[0]++,this.handle[0]={$:1,$0:w.setTimeout(h,this.interval)}):h()}},L,dn),dn.New=E.Ctor(function(a,l){L.New.call(this),this.interval=a==null?75:a.$0,this.maxCount=l==null?10:l.$0,this.handle=[null],this.count=[0]},dn),Ot.observer=function(a){return{OnCompleted:function(){return null},OnError:function(){return null},OnNext:a}},er.New=function(a,l,c,h){return{Value:a,Color:l,Highlight:c,Label:h}},Ct=x.DocElemNode=E.Class({Equals:function(a){return this.ElKey===a.ElKey},GetHashCode:function(){return this.ElKey}},null,Ct),Ct.New=function(a,l,c,h,d,p){var $;return new Ct(($={Attr:a,Children:l,El:h,ElKey:d},E.SetOptional($,"Delimiters",c),E.SetOptional($,"Render",p),$))},tr.fromSeq=function(a){var l;return l=m.ofSeq(R.map(function(c){return _t.New(c[0],c[1])},R.distinctBy(function(c){return c[0]},R.rev(a)))),m.sortInPlace(l),ce.Build(l,0,l.length-1)},qt.WriteLink=function(a,l){var c;return c=l.get_IsEmpty()?"":"?"+qt.WriteQuery(l),"/"+qt.Concat(a)+c},qt.Concat=function(a){var l,c;return l=[],c=!0,K.iter(function(h){re.IsNullOrEmpty(h)||(c?c=!1:l.push("/"),l.push(h))},a),re.Join("",m.ofSeq(l))},qt.WriteQuery=function(a){function l(c,h){return c+"="+h}return re.concat("&",R.map(function(c){return l(c[0],c[1])},Dt.ToSeq(a)))},ve.$cctor=function(){ve.$cctor=w.ignore,ve.LoadedTemplates=new Ne.New$5,ve.LocalTemplatesLoaded=!1,ve.GlobalHoles=new Ne.New$5,ve.TextHoleRE="\\${([^}]+)}",ve.RenderedFullDocTemplate=null},Se.convertTextNode=function(a){var l,c,h,d,p;for(l=null,c=0,h=a.textContent,d=new w.RegExp(B.TextHoleRE(),"g");l=d.exec(h),l!==null;)a.parentNode.insertBefore(self.document.createTextNode(Ze.string(h,{$:1,$0:c},{$:1,$0:d.lastIndex-m.get(l,0).length-1})),a),c=d.lastIndex,p=self.document.createElement("span"),p.setAttribute("ws-replace",m.get(l,1).toLowerCase()),a.parentNode.insertBefore(p,a);d.lastIndex=0,a.textContent=Ze.string(h,{$:1,$0:c},null)},Se.failNotLoaded=function(a){ke.warn("Instantiating non-loaded template",a)},Se.fillTextHole=function(a,l,c){var h;return h=a.querySelector("[ws-replace]"),_.Equals(h,null)?(ke.warn("Filling non-existent text hole",c),null):(h.parentNode.replaceChild(self.document.createTextNode(l),h),{$:1,$0:h.getAttribute("ws-replace")})},Se.removeHolesExcept=function(a,l){function c(h){B.foreachNotPreserved(a,"["+h+"]",function(d){l.Contains(d.getAttribute(h))||d.removeAttribute(h)})}c("ws-attr"),c("ws-onafterrender"),c("ws-var"),B.foreachNotPreserved(a,"[ws-hole]",function(h){if(!l.Contains(h.getAttribute("ws-hole")))for(h.removeAttribute("ws-hole");h.hasChildNodes();)h.removeChild(h.lastChild)}),B.foreachNotPreserved(a,"[ws-replace]",function(h){l.Contains(h.getAttribute("ws-replace"))||h.parentNode.removeChild(h)}),B.foreachNotPreserved(a,"[ws-on]",function(h){h.setAttribute("ws-on",re.concat(" ",m.filter(function(d){return l.Contains(m.get(re.SplitChars(d,[":"],1),1))},re.SplitChars(h.getAttribute("ws-on"),[" "],1))))}),B.foreachNotPreserved(a,"[ws-attr-holes]",function(h){var d,p,$,g,C;for(d=re.SplitChars(h.getAttribute("ws-attr-holes"),[" "],1),p=0,$=d.length-1;p<=$;p++)g=m.get(d,p),h.setAttribute(g,(C=new w.RegExp(B.TextHoleRE(),"g"),h.getAttribute(g).replace(C,function(S,D){return l.Contains(D)?S:""})))})},Se.fillInstanceAttrs=function(a,l){var c,h,d,p,$;if(Se.convertAttrs(l),c=l.nodeName.toLowerCase(),h=a.querySelector("[ws-attr="+c+"]"),_.Equals(h,null))ke.warn("Filling non-existent attr hole",c);else for(h.removeAttribute("ws-attr"),d=0,p=l.attributes.length-1;d<=p;d++)$=l.attributes.item(d),$.name=="class"&&h.hasAttribute("class")?h.setAttribute("class",h.getAttribute("class")+" "+$.nodeValue):h.setAttribute($.name,$.nodeValue)},Se.mapHoles=function(a,l){function c(h){B.foreachNotPreserved(a,"["+h+"]",function(d){var p,$;p=($=null,[l.TryGetValue(d.getAttribute(h).toLowerCase(),{get:function(){return $},set:function(g){$=g}}),$]),p[0]&&d.setAttribute(h,p[1])})}c("ws-hole"),c("ws-replace"),c("ws-attr"),c("ws-onafterrender"),c("ws-var"),B.foreachNotPreserved(a,"[ws-on]",function(h){h.setAttribute("ws-on",re.concat(" ",m.map(function(d){var p,$,g;return p=re.SplitChars(d,[":"],1),$=(g=null,[l.TryGetValue(m.get(p,1),{get:function(){return g},set:function(C){g=C}}),g]),$[0]?m.get(p,0)+":"+$[1]:d},re.SplitChars(h.getAttribute("ws-on"),[" "],1))))}),B.foreachNotPreserved(a,"[ws-attr-holes]",function(h){var d,p,$;for(d=re.SplitChars(h.getAttribute("ws-attr-holes"),[" "],1),p=0,$=d.length-1;p<=$;p++)(function(){var g;function C(S,D){var q;return q=he.KeyValue(D),S.replace(new w.RegExp("\\${"+q[0]+"}","ig"),"${"+q[1]+"}")}return g=m.get(d,p),h.setAttribute(g,E.Curried3(R.fold)(C)(h.getAttribute(g))(l))})()})},Se.fill=function(a,l,c){for(;;)if(a.hasChildNodes())c=l.insertBefore(a.lastChild,c);else return null},Se.convertAttrs=function(a){var l,c,h,d,p,$,g,C;function S(D){var q;q=a.getAttribute(D),q==null||a.setAttribute(D,q.toLowerCase())}for(l=a.attributes,c=[],h=[],d=[],p=0,$=l.length-1;p<=$;p++)g=l.item(p),re.StartsWith(g.nodeName,"ws-on")&&g.nodeName!="ws-onafterrender"&&g.nodeName!="ws-on"?(c.push(g.nodeName),h.push(Ze.string(g.nodeName,{$:1,$0:5},null)+":"+g.nodeValue.toLowerCase())):!re.StartsWith(g.nodeName,"ws-")&&new w.RegExp(B.TextHoleRE()).test(g.nodeValue)&&(g.nodeValue=(C=new w.RegExp(B.TextHoleRE(),"g"),g.nodeValue.replace(C,function(D,q){return"${"+q.toLowerCase()+"}"})),d.push(g.nodeName));h.length!=0&&a.setAttribute("ws-on",re.concat(" ",h)),d.length!=0&&a.setAttribute("ws-attr-holes",re.concat(" ",d)),S("ws-hole"),S("ws-replace"),S("ws-attr"),S("ws-onafterrender"),S("ws-var"),m.iter(function(D){a.removeAttribute(D)},c)},we.ParseHTMLIntoFakeRoot=function(a){var l,c,h,d,p;function $(g,C){for(var S;;){if(C===0)return g;S=C,g=g.lastChild,C=S-1}}return l=self.document.createElement("div"),we.rhtml().test(a)?(c=(h=we.rtagName().exec(a),_.Equals(h,null)?"":m.get(h,1).toLowerCase()),d=(p=we.wrapMap()[c],p||we.defaultWrap()),l.innerHTML=d[1]+a.replace(we.rxhtmlTag(),"<$1></$2>")+d[2],$(l,d[0])):(l.appendChild(self.document.createTextNode(a)),l)},we.rhtml=function(){return Me.$cctor(),Me.rhtml},we.wrapMap=function(){return Me.$cctor(),Me.wrapMap},we.defaultWrap=function(){return Me.$cctor(),Me.defaultWrap},we.rxhtmlTag=function(){return Me.$cctor(),Me.rxhtmlTag},we.rtagName=function(){return Me.$cctor(),Me.rtagName},we.IterSelector=function(a,l,c){var h,d,p;for(h=a.querySelectorAll(l),d=0,p=h.length-1;d<=p;d++)c(h[d])},we.ChildrenArray=function(a){var l,c,h;for(l=[],c=0,h=a.childNodes.length-1;c<=h;c++)l.push(a.childNodes[c]);return l},we.IterSelectorDoc=function(a,l){var c,h,d;for(c=self.document.querySelectorAll(a),h=0,d=c.length-1;h<=d;h++)l(c[h])},we.InsertAt=function(a,l,c){var h;c.parentNode===a&&l===(h=c.nextSibling,_.Equals(h,null)?null:h)||a.insertBefore(c,l)},we.RemoveNode=function(a,l){l.parentNode===a&&a.removeChild(l)},it=x.Elt=E.Class({},ae,it),it.TreeNode=function(a,l){var c,h;function d(p,$){return ee.Updates($)}return c=vt.Create(l),new it.New$1({$:6,$0:a},W.Map2Unit((h=m.map(function(p){return d(p[0],p[1])},a.Attrs),Pe.TreeReduce(W.Const(),W.Map2Unit,h)),c.v),m.get(a.Els,0),c)},it.New=function(a,l,c){var h,d;return h=Z.CreateElemNode(a,l,c.docNode),d=vt.Create(c.updates),new it.New$1({$:1,$0:h},W.Map2Unit(ee.Updates(h.Attr),d.v),a,d)},it.New$1=E.Ctor(function(a,l,c,h){ae.New.call(this,a,l),this.docNode$1=a,this.updates$1=l,this.elt=c,this.rvUpdates=h},it),Ae.get_UseAnimations=function(){return Fe.UseAnimations()},Ae.Play=function(a){return G.Delay(function(){return G.Bind(Ae.Run(w.ignore,Fe.Actions(a)),function(){return Fe.Finalize(a),G.Return(null)})})},Ae.Append=function(a,l){return{$:0,$0:Xe.Append(a.$0,l.$0)}},Ae.Run=function(a,l){var c;function h(d){function p($){return function(g){var C;return C=g-$,l.Compute(C),a(),C<=c?void w.requestAnimationFrame(function(S){p($)(S)}):d()}}w.requestAnimationFrame(function($){p($)($)})}return c=l.Duration,c===0?G.Zero():G.FromContinuations(function(d,p,$){return h.apply(null,[d,p,$])})},Ae.Concat=function(a){return{$:0,$0:Xe.Concat(R.map(Fe.List,a))}},Ae.get_Empty=function(){return{$:0,$0:Xe.Empty()}},Mn.BatchUpdatesEnabled=function(){return $n.$cctor(),$n.BatchUpdatesEnabled},nr.StartProcessor=function(a){var l;function c(){return G.Delay(function(){return G.Bind(a,function(){var h;return h=l[0],_.Equals(h,1)?(l[0]=0,G.Zero()):_.Equals(h,2)?(l[0]=1,c()):G.Zero()})})}return l=[0],function(){var h;h=l[0],_.Equals(h,0)?(l[0]=1,G.Start(c(),null)):_.Equals(h,1)&&(l[0]=2)}},ye=x.AttrProxy=E.Class({},null,ye),ye.Create=function(a,l){return ee.Static(function(c){c.setAttribute(a,l)})},ye.Handler=function(a,l){return ye.HandlerImpl(a,l)},ye.Concat=function(a){var l;return l=Pe.ofSeqNonCopying(a),Pe.TreeReduce(ee.EmptyAttr(),ye.Append,l)},ye.HandlerImpl=function(a,l){return ee.Static(function(c){c.addEventListener(a,function(h){return l(c)(h)},!1)})},ye.Append=function(a,l){return ee.AppendTree(a,l)},ee.Static=function(a){return new ye({$:3,$0:a})},ee.Insert=function(a,l){var c,h,d;function p($){for(var g,C;;)if($!==null){if($!=null&&$.$==1)return c.push($.$0);if($!=null&&$.$==2)g=$.$1,C=$.$0,p(C),$=g;else return $!=null&&$.$==3?$.$0(a):$!=null&&$.$==4?h.push($.$0):null}else return null}return c=[],h=[],p(l),d=c.slice(0),Pn.New(a,ee.Flags(l),d,h.length===0?null:{$:1,$0:function($){R.iter(function(g){g($)},h)}})},ee.Updates=function(a){return Pe.MapTreeReduce(function(l){return l.NChanged()},W.Const(),W.Map2Unit,a.DynNodes)},ee.Empty=function(a){return Pn.New(a,0,[],null)},ee.Flags=function(a){return a!==null&&a.hasOwnProperty("flags")?a.flags:0},ee.Dynamic=function(a,l){return new ye({$:1,$0:new gn.New(a,l)})},ee.EmptyAttr=function(){return Q.$cctor(),Q.EmptyAttr},ee.HasExitAnim=function(a){var l;return l=2,(a.DynFlags&l)===l},ee.GetExitAnim=function(a){return ee.GetAnim(a,function(l,c){return l.NGetExitAnim(c)})},ee.HasEnterAnim=function(a){var l;return l=1,(a.DynFlags&l)===l},ee.GetEnterAnim=function(a){return ee.GetAnim(a,function(l,c){return l.NGetEnterAnim(c)})},ee.HasChangeAnim=function(a){var l;return l=4,(a.DynFlags&l)===l},ee.GetChangeAnim=function(a){return ee.GetAnim(a,function(l,c){return l.NGetChangeAnim(c)})},ee.AppendTree=function(a,l){var c;return a===null?l:l===null?a:(c=new ye({$:2,$0:a,$1:l}),ee.SetFlags(c,ee.Flags(a)|ee.Flags(l)),c)},ee.GetAnim=function(a,l){return Ae.Concat(m.map(function(c){return l(c,a.DynElem)},a.DynNodes))},ee.Sync=function(a,l){m.iter(function(c){c.NSync(a)},l.DynNodes)},ee.SetFlags=function(a,l){a.flags=l},Pn.New=function(a,l,c,h){var d;return d={DynElem:a,DynFlags:l,DynNodes:c},E.SetOptional(d,"OnAfterRender",h),d},ce.OfSeq=function(a){var l;return l=m.ofSeq(R.distinct(a)),m.sortInPlace(l),ce.Build(l,0,l.length-1)},ce.Enumerate=function(a,l){function c(h,d){for(var p;;){if(h==null)return d.$==1?{$:1,$0:[d.$0[0],[d.$0[1],d.$1]]}:null;a?(p=h,h=p.Right,d=new le({$:1,$0:[p.Node,p.Left],$1:d})):(p=h,h=p.Left,d=new le({$:1,$0:[p.Node,p.Right],$1:d}))}}return R.unfold(function(h){return c(h[0],h[1])},[l,le.Empty])},ce.Build=function(a,l,c){var h,d,p;return c-l+1<=0?null:(h=(l+c)/2>>0,d=ce.Build(a,l,h-1),p=ce.Build(a,h+1,c),ce.Branch(m.get(a,h),d,p))},ce.Branch=function(a,l,c){var h,d;return Zn.New(a,l,c,1+(h=l==null?0:l.Height,d=c==null?0:c.Height,_.Compare(h,d)===1?h:d),1+(l==null?0:l.Count)+(c==null?0:c.Count))},ce.Add=function(a,l){return ce.Put(function(c,h){return h},a,l)},ce.Put=function(a,l,c){var h,d;return h=ce.Lookup(l,c),d=h[0],d==null?ce.Rebuild(h[1],ce.Branch(l,null,null)):ce.Rebuild(h[1],ce.Branch(a(d.Node,l),d.Left,d.Right))},ce.Lookup=function(a,l){var c,h,d,p;for(c=[],h=l,d=!0;d;)h==null?d=!1:(p=_.Compare(a,h.Node),p===0?d=!1:p===1?(c.unshift([!0,h.Node,h.Left]),h=h.Right):(c.unshift([!1,h.Node,h.Right]),h=h.Left));return[h,c]},ce.Rebuild=function(a,l){var c,h,d,p,$,g,C,S,D,q;function F(I){return I==null?0:I.Height}for(c=l,h=0,d=m.length(a)-1;h<=d;h++)c=(p=m.get(a,h),p[0]?($=p[1],g=p[2],F(c)>F(g)+1?F(c.Left)===F(c.Right)+1?(C=c.Left,ce.Branch(C.Node,ce.Branch($,g,C.Left),ce.Branch(c.Node,C.Right,c.Right))):ce.Branch(c.Node,ce.Branch($,g,c.Left),c.Right):ce.Branch($,g,c)):(S=p[1],D=p[2],F(c)>F(D)+1?F(c.Right)===F(c.Left)+1?(q=c.Right,ce.Branch(q.Node,ce.Branch(c.Node,c.Left,q.Left),ce.Branch(S,q.Right,D))):ce.Branch(c.Node,c.Left,ce.Branch(S,c.Right,D)):ce.Branch(S,c,D)));return c},In=ue.Attribute=E.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},de,In),bn=ue.Event=E.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},de,bn),Vn=ue.AfterRender=E.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},de,Vn),Ln=ue.AfterRenderQ=E.Class({get_Value:function(){return this.fillWith},get_Name:function(){return this.name}},de,Ln),Pe.TreeReduce=function(a,l,c){var h;function d(p){return function($){var g;switch($<=0?0:$===1&&p>=0&&p<h?1:2){case 0:return a;case 1:return m.get(c,p);case 2:return g=$/2>>0,l(d(p)(g),d(p+g)($-g))}}}return h=m.length(c),d(0)(h)},Pe.mapInPlace=function(a,l){var c,h;for(c=0,h=l.length-1;c<=h;c++)l[c]=a(l[c]);return l},Pe.ofSeqNonCopying=function(a){var l,c;if(a instanceof w.Array)return a;if(a instanceof le)return m.ofList(a);if(a===null)return[];l=[],c=Y.Get(a);try{for(;c.MoveNext();)l.push(c.Current());return l}finally{typeof c=="object"&&"Dispose"in c&&c.Dispose()}},Pe.MapTreeReduce=function(a,l,c,h){var d;function p($){return function(g){var C;switch(g<=0?0:g===1&&$>=0&&$<d?1:2){case 0:return l;case 1:return a(m.get(h,$));case 2:return C=g/2>>0,c(p($)(C),p($+C)(g-C))}}}return d=m.length(h),p(0)(d)},vt=x.Updates=E.Class({},null,vt),vt.Create=function(a){var l;return l=null,l=vt.New(a,null,function(){var c;return c=l.s,c===null&&(c=T.Copy(l.c()),l.s=c,T.WhenObsoleteRun(c,function(){l.s=null})),c}),l},vt.New=function(a,l,c){return new vt({c:a,s:l,v:c})},pn=pe.ValueCollection=E.Class({GetEnumerator:function(){return Y.Get(R.map(function(a){return a.V},this.d))}},L,pn),pn.New=E.Ctor(function(a){L.New.call(this),this.d=a},pn),ir.New=function(a,l){return{PreviousNodes:a,Top:l}},De.get_Empty=function(){return{$:0,$0:new Ce.New$3}},De.FindAll=function(a){var l;function c(p,$){for(var g,C,S,D,q;;)switch(p){case 0:if($!=null&&$.$==0)C=$.$1,S=$.$0,c(0,S),$=C;else if($!=null&&$.$==1)D=$.$0,$=D,p=1;else if($!=null&&$.$==2)q=$.$0,$=q.Current;else return $!=null&&$.$==6?(g=$.$0.Holes,function(F){return function(I){m.iter(F,I)}}(d)(g)):null;break;case 1:l.push($),$=$.Children,p=0;break}}function h(p){return c(0,p)}function d(p){return c(1,p)}return l=[],h(a),{$:0,$0:new Ce.New$2(l)}},De.Filter=function(a,l){return{$:0,$0:qe.Filter(a,l.$0)}},De.Except=function(a,l){return{$:0,$0:qe.Except(a.$0,l.$0)}},De.ToArray=function(a){return qe.ToArray(a.$0)},De.Intersect=function(a,l){return{$:0,$0:qe.Intersect(a.$0,l.$0)}},Fe.UseAnimations=function(){return Ht.$cctor(),Ht.UseAnimations},Fe.Actions=function(a){return Fe.ConcatActions(m.choose(function(l){return l.$==1?{$:1,$0:l.$0}:null},Xe.ToArray(a.$0)))},Fe.Finalize=function(a){m.iter(function(l){l.$==0&&l.$0()},Xe.ToArray(a.$0))},Fe.ConcatActions=function(a){var l,c,h,d;return l=Pe.ofSeqNonCopying(a),c=m.length(l),c===0?Fe.Const():c===1?m.get(l,0):(h=R.max(R.map(function(p){return p.Duration},l)),d=m.map(function(p){return Fe.Prolong(h,p)},l),Fe.Def(h,function(p){m.iter(function($){$.Compute(p)},d)}))},Fe.List=function(a){return a.$0},Fe.Const=function(a){return Fe.Def(0,function(){return a})},Fe.Def=function(a,l){return{Compute:l,Duration:a}},Fe.Prolong=function(a,l){var c,h,d;return c=l.Compute,h=l.Duration,d=jt.Create(function(){return l.Compute(l.Duration)}),{Compute:function(p){return p>=h?d.f():c(p)},Duration:a}},$n.$cctor=function(){$n.$cctor=w.ignore,$n.BatchUpdatesEnabled=!0},ur.Clear=function(a){a.splice(0,m.length(a))},R.insufficient=function(){return he.FailWith("The input sequence has an insufficient number of elements.")},m.mapiInPlace=function(a,l){var c,h;for(c=0,h=l.length-1;c<=h;c++)l[c]=a(c,l[c]);return l},m.mapInPlace=function(a,l){var c,h;for(c=0,h=l.length-1;c<=h;c++)l[c]=a(l[c])},R.nonNegative=function(){return he.FailWith("The input must be non-negative.")},mn=pe.KeyCollection=E.Class({GetEnumerator:function(){return Y.Get(R.map(function(a){return a.K},this.d))}},L,mn),mn.New=E.Ctor(function(a){L.New.call(this),this.d=a},mn),Sn.concat=function(a){var l;l=[];for(var c in a)l.push.apply(l,a[c]);return l},Me.$cctor=function(){var a;Me.$cctor=w.ignore,Me.rxhtmlTag=new w.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi"),Me.rtagName=new w.RegExp("<([\\w:]+)"),Me.rhtml=new w.RegExp("<|&#?\\w+;"),Me.wrapMap=(a=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:a,tbody:a,tfoot:a,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]}),Me.defaultWrap=[0,"",""]},Ht.$cctor=function(){Ht.$cctor=w.ignore,Ht.CubicInOut=Ft.Custom(function(a){var l;return l=a*a,3*l-2*(l*a)}),Ht.UseAnimations=!0},Xe.Append=function(a,l){return a.$==0?l:l.$==0?a:{$:2,$0:a,$1:l}},Xe.ToArray=function(a){var l;function c(h){for(var d,p;;){if(h.$==1)return l.push(h.$0);if(h.$==2)d=h.$1,p=h.$0,c(p),h=d;else return h.$==3?m.iter(function($){l.push($)},h.$0):null}}return l=[],c(a),l.slice(0)},Xe.Concat=function(a){var l;return l=Pe.ofSeqNonCopying(a),Pe.TreeReduce(Xe.Empty(),Xe.Append,l)},Xe.Empty=function(){return wn.$cctor(),wn.Empty},ct=N.KeyNotFoundException=E.Class({},_n,ct),ct.New=E.Ctor(function(){ct.New$1.call(this,"The given key was not present in the dictionary.")},ct),ct.New$1=E.Ctor(function(a){this.message=a,tn.setPrototypeOf(this,ct.prototype)},ct),gn=x.DynamicAttrNode=E.Class({NChanged:function(){return this.updates},NGetExitAnim:function(a){return Ae.get_Empty()},NGetEnterAnim:function(a){return Ae.get_Empty()},NGetChangeAnim:function(a){return Ae.get_Empty()},NSync:function(a){this.dirty&&(this.push(a)(this.value),this.dirty=!1)}},L,gn),gn.New=E.Ctor(function(a,l){var c;c=this,L.New.call(this),this.push=l,this.value=void 0,this.dirty=!1,this.updates=W.Map(function(h){c.value=h,c.dirty=!0},a)},gn),Q.$cctor=function(){var a,l,c,h,d,p,$,g,C,S,D,q,F,I;Q.$cctor=w.ignore,Q.EmptyAttr=null,Q.BoolCheckedApply=function(P){function b(j,k){return k!=null&&k.$==1?void(j.checked=k.$0):null}return[function(j){j.addEventListener("change",function(){return P.Get()!=j.checked?P.Set(j.checked):null})},function(j){return function(k){return b(j,k)}},W.Map(function(j){return{$:1,$0:j}},P.get_View())]},Q.StringSet=function(P){return function(b){P.value=b}},Q.StringGet=function(P){return{$:1,$0:P.value}},Q.StringApply=(a=te.StringGet(),l=te.StringSet(),function(P){return te.ApplyValue(a,l,P)}),Q.DateTimeSetUnchecked=function(P){return function(b){P.value=new Kt(b).toLocaleString()}},Q.DateTimeGetUnchecked=function(P){var b,j,k,U;return b=P.value,Bt.isBlank(b)?{$:1,$0:-864e13}:(j=(k=0,[(U=ar.TryParse(b),U!=null&&U.$==1&&(k=U.$0,!0)),k]),j[0]?{$:1,$0:j[1]}:null)},Q.DateTimeApplyUnchecked=(c=te.DateTimeGetUnchecked(),h=te.DateTimeSetUnchecked(),function(P){return te.ApplyValue(c,h,P)}),Q.FileSetUnchecked=function(){return function(){return null}},Q.FileGetUnchecked=function(P){var b;return b=P.files,{$:1,$0:m.ofSeq(R.delay(function(){return R.map(function(j){return b.item(j)},he.range(0,b.length-1))}))}},Q.FileApplyUnchecked=(d=te.FileGetUnchecked(),p=te.FileSetUnchecked(),function(P){return te.FileApplyValue(d,p,P)}),Q.IntSetUnchecked=function(P){return function(b){P.value=w.String(b)}},Q.IntGetUnchecked=function(P){var b,j;return b=P.value,Bt.isBlank(b)?{$:1,$0:0}:(j=+b,j!==j>>0?null:{$:1,$0:j})},Q.IntApplyUnchecked=($=te.IntGetUnchecked(),g=te.IntSetUnchecked(),function(P){return te.ApplyValue($,g,P)}),Q.IntSetChecked=function(P){return function(b){var j;return j=b.get_Input(),P.value!=j?void(P.value=j):null}},Q.IntGetChecked=function(P){var b,j,k;return b=P.value,{$:1,$0:Bt.isBlank(b)?!P.checkValidity||P.checkValidity()?new ut({$:2,$0:b}):new ut({$:1,$0:b}):(j=(k=0,[Nn.TryParseInt32(b,{get:function(){return k},set:function(U){k=U}}),k]),j[0]?new ut({$:0,$0:j[1],$1:b}):new ut({$:1,$0:b}))}},Q.IntApplyChecked=(C=te.IntGetChecked(),S=te.IntSetChecked(),function(P){return te.ApplyValue(C,S,P)}),Q.FloatSetUnchecked=function(P){return function(b){P.value=w.String(b)}},Q.FloatGetUnchecked=function(P){var b,j;return b=P.value,Bt.isBlank(b)?{$:1,$0:0}:(j=+b,w.isNaN(j)?null:{$:1,$0:j})},Q.FloatApplyUnchecked=(D=te.FloatGetUnchecked(),q=te.FloatSetUnchecked(),function(P){return te.ApplyValue(D,q,P)}),Q.FloatSetChecked=function(P){return function(b){var j;return j=b.get_Input(),P.value!=j?void(P.value=j):null}},Q.FloatGetChecked=function(P){var b,j;return b=P.value,{$:1,$0:Bt.isBlank(b)?!P.checkValidity||P.checkValidity()?new ut({$:2,$0:b}):new ut({$:1,$0:b}):(j=+b,w.isNaN(j)?new ut({$:1,$0:b}):new ut({$:0,$0:j,$1:b}))}},Q.FloatApplyChecked=(F=te.FloatGetChecked(),I=te.FloatSetChecked(),function(P){return te.ApplyValue(F,I,P)})},Ft=x.Easing=E.Class({},L,Ft),Ft.Custom=function(a){return new Ft.New(a)},Ft.New=E.Ctor(function(a){L.New.call(this),this.transformTime=a},Ft),qe.Filter=function(a,l){return new Ce.New$2(m.filter(a,qe.ToArray(l)))},qe.Except=function(a,l){var c;return c=new Ce.New$2(qe.ToArray(l)),c.ExceptWith(qe.ToArray(a)),c},qe.ToArray=function(a){var l;return l=m.create(a.Count(),void 0),a.CopyTo(l,0),l},qe.Intersect=function(a,l){var c;return c=new Ce.New$2(qe.ToArray(a)),c.IntersectWith(qe.ToArray(l)),c},te.ApplyValue=function(a,l,c){var h;function d(p,$){return $==null?null:p($.$0)}return h=null,[function(p){function $(){c.UpdateMaybe(function(g){var C;return h=a(p),h!=null&&h.$==1&&!_.Equals(h.$0,g)&&(C=[h,h.$0],!0)?C[0]:null})}p.addEventListener("change",$),p.addEventListener("input",$),p.addEventListener("keypress",$)},function(p){var $;return $=l(p),function(g){return d($,g)}},W.Map(function(p){return h!=null&&h.$==1&&_.Equals(h.$0,p)&&(h.$0,!0)?null:{$:1,$0:p}},c.get_View())]},te.StringSet=function(){return Q.$cctor(),Q.StringSet},te.StringGet=function(){return Q.$cctor(),Q.StringGet},te.DateTimeSetUnchecked=function(){return Q.$cctor(),Q.DateTimeSetUnchecked},te.DateTimeGetUnchecked=function(){return Q.$cctor(),Q.DateTimeGetUnchecked},te.FileApplyValue=function(a,l,c){var h;function d(p,$){return $==null?null:p($.$0)}return h=null,[function(p){p.addEventListener("change",function(){c.UpdateMaybe(function($){var g;return h=a(p),h!=null&&h.$==1&&h.$0!==$&&(g=[h,h.$0],!0)?g[0]:null})})},function(p){var $;return $=l(p),function(g){return d($,g)}},W.Map(function(p){return h!=null&&h.$==1&&_.Equals(h.$0,p)&&(h.$0,!0)?null:{$:1,$0:p}},c.get_View())]},te.FileSetUnchecked=function(){return Q.$cctor(),Q.FileSetUnchecked},te.FileGetUnchecked=function(){return Q.$cctor(),Q.FileGetUnchecked},te.IntSetUnchecked=function(){return Q.$cctor(),Q.IntSetUnchecked},te.IntGetUnchecked=function(){return Q.$cctor(),Q.IntGetUnchecked},te.IntSetChecked=function(){return Q.$cctor(),Q.IntSetChecked},te.IntGetChecked=function(){return Q.$cctor(),Q.IntGetChecked},te.FloatSetUnchecked=function(){return Q.$cctor(),Q.FloatSetUnchecked},te.FloatGetUnchecked=function(){return Q.$cctor(),Q.FloatGetUnchecked},te.FloatSetChecked=function(){return Q.$cctor(),Q.FloatSetChecked},te.FloatGetChecked=function(){return Q.$cctor(),Q.FloatGetChecked},te.FloatApplyUnchecked=function(){return Q.$cctor(),Q.FloatApplyUnchecked},te.StringApply=function(){return Q.$cctor(),Q.StringApply},te.BoolCheckedApply=function(){return Q.$cctor(),Q.BoolCheckedApply},te.DateTimeApplyUnchecked=function(){return Q.$cctor(),Q.DateTimeApplyUnchecked},te.FileApplyUnchecked=function(){return Q.$cctor(),Q.FileApplyUnchecked},Bt.isBlank=function(a){return re.forall(or.IsWhiteSpace,a)},ut=x.CheckedInput=E.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1}},null,ut),yt.Children=function(a,l){var c,h,d;if(l!=null&&l.$==1){for(d=[],c=l.$0[0].nextSibling;c!==l.$0[1];)d.push(c),c=c.nextSibling;return{$:0,$0:d}}else return{$:0,$0:m.init(a.childNodes.length,(h=a.childNodes,function(p){return h[p]}))}},yt.Except=function(a,l){var c;return c=a.$0,{$:0,$0:m.filter(function(h){return m.forall(function(d){return h!==d},c)},l.$0)}},yt.Iter=function(a,l){m.iter(a,l.$0)},yt.DocChildren=function(a){var l;function c(h){for(var d,p,$,g;;)if(h!=null&&h.$==2)p=h.$0,h=p.Current;else{if(h!=null&&h.$==1)return l.push(h.$0.El);if(h==null)return null;if(h!=null&&h.$==5)return l.push(h.$0);if(h!=null&&h.$==4)return l.push(h.$0.Text);if(h!=null&&h.$==6)return d=h.$0.Els,function(C){return function(S){m.iter(C,S)}}(function(C){C==null||C.constructor===tn?c(C):l.push(C)})(d);$=h.$1,g=h.$0,c(g),h=$}}return l=[],c(a.Children),{$:0,$0:Pe.ofSeqNonCopying(l)}},or.IsWhiteSpace=function(a){return a.match(new w.RegExp("\\s"))!==null},ar.TryParse=function(a){var l;return l=Kt.parse(a),w.isNaN(l)?null:{$:1,$0:l}},Nn.TryParse=function(a,l,c,h){var d,p;return d=+a,p=d===d-d%1&&d>=l&&d<=c,p&&h.set(d),p},jt.Create=function(a){return cr.New(!1,a,jt.forceLazy)},jt.forceLazy=function(){var a;return a=this.v(),this.c=!0,this.v=a,this.f=jt.cachedLazy,a},jt.cachedLazy=function(){return this.v},wn.$cctor=function(){wn.$cctor=w.ignore,wn.Empty={$:0}},cr.New=function(a,l,c){return{c:a,v:l,f:c}},E.OnLoad(function(){A.Main()})})(self);typeof WebSharper<"u"&&(WebSharper.Runtime.ScriptBasePath="/Content/",WebSharper.Runtime.Start());
